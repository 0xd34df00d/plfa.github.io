---
src       : "src/plfa/part3/Soundness.lagda.md"
title     : "Soundness: Soundness of reduction with respect to denotational semantics üöß"
layout    : page
prev      : /Compositional/
permalink : /Soundness/
next      : /Adequacy/
---

{% raw %}<pre class="Agda"><a id="195" class="Keyword">module</a> <a id="202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}" class="Module">plfa.part3.Soundness</a> <a id="223" class="Keyword">where</a>
</pre>{% endraw %}

## Introduction

In this chapter we prove that the reduction semantics is sound with
respect to the denotational semantics, i.e., for any term L

    L ‚Äî‚Ü† ∆õ N  implies  ‚Ñ∞ L ‚âÉ ‚Ñ∞ (∆õ N)

The proof is by induction on the reduction sequence, so the main lemma
concerns a single reduction step. We prove that if any term `M` steps
to a term `N`, then `M` and `N` are denotationally equal. We shall
prove each direction of this if-and-only-if separately. One direction
will look just like a type preservation proof. The other direction is
like proving type preservation for reduction going in reverse.  Recall
that type preservation is sometimes called subject
reduction. Preservation in reverse is a well-known property and is
called _subject expansion_. It is also well-known that subject
expansion is false for most typed lambda calculi!


## Imports

{% raw %}<pre class="Agda"><a id="1087" class="Keyword">open</a> <a id="1092" class="Keyword">import</a> <a id="1099" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="1139" class="Keyword">using</a> <a id="1145" class="Symbol">(</a><a id="1146" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_‚â°_</a><a id="1149" class="Symbol">;</a> <a id="1151" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">_‚â¢_</a><a id="1154" class="Symbol">;</a> <a id="1156" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1160" class="Symbol">;</a> <a id="1162" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a><a id="1165" class="Symbol">;</a> <a id="1167" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#1090" class="Function">cong</a><a id="1171" class="Symbol">;</a> <a id="1173" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1436" class="Function">cong‚ÇÇ</a><a id="1178" class="Symbol">;</a> <a id="1180" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.html#1308" class="Function">cong-app</a><a id="1188" class="Symbol">)</a>
<a id="1190" class="Keyword">open</a> <a id="1195" class="Keyword">import</a> <a id="1202" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html" class="Module">Data.Product</a> <a id="1215" class="Keyword">using</a> <a id="1221" class="Symbol">(</a><a id="1222" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">_√ó_</a><a id="1225" class="Symbol">;</a> <a id="1227" href="Agda.Builtin.Sigma.html#139" class="Record">Œ£</a><a id="1228" class="Symbol">;</a> <a id="1230" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Œ£-syntax</a><a id="1238" class="Symbol">;</a> <a id="1240" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1364" class="Function">‚àÉ</a><a id="1241" class="Symbol">;</a> <a id="1243" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1783" class="Function">‚àÉ-syntax</a><a id="1251" class="Symbol">;</a> <a id="1253" href="Agda.Builtin.Sigma.html#225" class="Field">proj‚ÇÅ</a><a id="1258" class="Symbol">;</a> <a id="1260" href="Agda.Builtin.Sigma.html#237" class="Field">proj‚ÇÇ</a><a id="1265" class="Symbol">)</a>
  <a id="1269" class="Keyword">renaming</a> <a id="1278" class="Symbol">(</a><a id="1279" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a> <a id="1283" class="Symbol">to</a> <a id="1286" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®_,_‚ü©</a><a id="1291" class="Symbol">)</a>
<a id="1293" class="Keyword">open</a> <a id="1298" class="Keyword">import</a> <a id="1305" href="Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="1320" class="Keyword">using</a> <a id="1326" class="Symbol">(</a><a id="1327" href="Agda.Primitive.html#611" class="Primitive">lzero</a><a id="1332" class="Symbol">)</a>
<a id="1334" class="Keyword">open</a> <a id="1339" class="Keyword">import</a> <a id="1346" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1363" class="Keyword">using</a> <a id="1369" class="Symbol">(</a><a id="1370" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#535" class="Function Operator">¬¨_</a><a id="1372" class="Symbol">)</a>
<a id="1374" class="Keyword">open</a> <a id="1379" class="Keyword">import</a> <a id="1386" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1412" class="Keyword">using</a> <a id="1418" class="Symbol">(</a><a id="1419" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.Negation.html#809" class="Function">contradiction</a><a id="1432" class="Symbol">)</a>
<a id="1434" class="Keyword">open</a> <a id="1439" class="Keyword">import</a> <a id="1446" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html" class="Module">Data.Empty</a> <a id="1457" class="Keyword">using</a> <a id="1463" class="Symbol">(</a><a id="1464" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html#294" class="Function">‚ä•-elim</a><a id="1470" class="Symbol">)</a>
<a id="1472" class="Keyword">open</a> <a id="1477" class="Keyword">import</a> <a id="1484" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1501" class="Keyword">using</a> <a id="1507" class="Symbol">(</a><a id="1508" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#605" class="Datatype">Dec</a><a id="1511" class="Symbol">;</a> <a id="1513" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a><a id="1516" class="Symbol">;</a> <a id="1518" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a><a id="1520" class="Symbol">)</a>
<a id="1522" class="Keyword">open</a> <a id="1527" class="Keyword">import</a> <a id="1534" href="https://agda.github.io/agda-stdlib/v1.1/Function.html" class="Module">Function</a> <a id="1543" class="Keyword">using</a> <a id="1549" class="Symbol">(</a><a id="1550" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">_‚àò_</a><a id="1553" class="Symbol">)</a>
<a id="1555" class="Keyword">open</a> <a id="1560" class="Keyword">import</a> <a id="1567" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}" class="Module">plfa.part2.Untyped</a>
     <a id="1591" class="Keyword">using</a> <a id="1597" class="Symbol">(</a><a id="1598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3153" class="Datatype">Context</a><a id="1605" class="Symbol">;</a> <a id="1607" href="plfa.part2.Untyped.html#3191" class="InductiveConstructor Operator">_,_</a><a id="1610" class="Symbol">;</a> <a id="1612" href="plfa.part2.Untyped.html#3521" class="Datatype Operator">_‚àã_</a><a id="1615" class="Symbol">;</a> <a id="1617" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">_‚ä¢_</a><a id="1620" class="Symbol">;</a> <a id="1622" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="1623" class="Symbol">;</a> <a id="1625" href="plfa.part2.Untyped.html#3557" class="InductiveConstructor">Z</a><a id="1626" class="Symbol">;</a> <a id="1628" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S_</a><a id="1630" class="Symbol">;</a> <a id="1632" href="plfa.part2.Untyped.html#4330" class="InductiveConstructor Operator">`_</a><a id="1634" class="Symbol">;</a> <a id="1636" href="plfa.part2.Untyped.html#4382" class="InductiveConstructor Operator">∆õ_</a><a id="1638" class="Symbol">;</a> <a id="1640" href="plfa.part2.Untyped.html#4442" class="InductiveConstructor Operator">_¬∑_</a><a id="1643" class="Symbol">;</a>
            <a id="1657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a><a id="1662" class="Symbol">;</a> <a id="1664" href="plfa.part2.Untyped.html#7491" class="Function Operator">_[_]</a><a id="1668" class="Symbol">;</a> <a id="1670" href="plfa.part2.Untyped.html#7375" class="Function">subst-zero</a><a id="1680" class="Symbol">;</a> <a id="1682" href="plfa.part2.Untyped.html#5925" class="Function">ext</a><a id="1685" class="Symbol">;</a> <a id="1687" href="plfa.part2.Untyped.html#6235" class="Function">rename</a><a id="1693" class="Symbol">;</a> <a id="1695" href="plfa.part2.Untyped.html#6671" class="Function">exts</a><a id="1699" class="Symbol">;</a>
            <a id="1713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">_‚Äî‚Üí_</a><a id="1717" class="Symbol">;</a> <a id="1719" href="plfa.part2.Untyped.html#9998" class="InductiveConstructor">Œæ‚ÇÅ</a><a id="1721" class="Symbol">;</a> <a id="1723" href="plfa.part2.Untyped.html#10088" class="InductiveConstructor">Œæ‚ÇÇ</a><a id="1725" class="Symbol">;</a> <a id="1727" href="plfa.part2.Untyped.html#10178" class="InductiveConstructor">Œ≤</a><a id="1728" class="Symbol">;</a> <a id="1730" href="plfa.part2.Untyped.html#10286" class="InductiveConstructor">Œ∂</a><a id="1731" class="Symbol">;</a> <a id="1733" href="plfa.part2.Untyped.html#11068" class="Datatype Operator">_‚Äî‚Ü†_</a><a id="1737" class="Symbol">;</a> <a id="1739" href="plfa.part2.Untyped.html#11174" class="InductiveConstructor Operator">_‚Äî‚Üí‚ü®_‚ü©_</a><a id="1746" class="Symbol">;</a> <a id="1748" href="plfa.part2.Untyped.html#11118" class="InductiveConstructor Operator">_‚àé</a><a id="1750" class="Symbol">)</a>
<a id="1752" class="Keyword">open</a> <a id="1757" class="Keyword">import</a> <a id="1764" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}" class="Module">plfa.part2.Substitution</a> <a id="1788" class="Keyword">using</a> <a id="1794" class="Symbol">(</a><a id="1795" href="plfa.part2.Substitution.html#2192" class="Function">Rename</a><a id="1801" class="Symbol">;</a> <a id="1803" href="plfa.part2.Substitution.html#2405" class="Function">Subst</a><a id="1808" class="Symbol">;</a> <a id="1810" href="plfa.part2.Substitution.html#3046" class="Function">ids</a><a id="1813" class="Symbol">)</a>
<a id="1815" class="Keyword">open</a> <a id="1820" class="Keyword">import</a> <a id="1827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}" class="Module">plfa.part3.Denotational</a>
     <a id="1856" class="Keyword">using</a> <a id="1862" class="Symbol">(</a><a id="1863" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4067" class="Datatype">Value</a><a id="1868" class="Symbol">;</a> <a id="1870" href="plfa.part3.Denotational.html#4087" class="InductiveConstructor">‚ä•</a><a id="1871" class="Symbol">;</a> <a id="1873" href="plfa.part3.Denotational.html#7204" class="Function">Env</a><a id="1876" class="Symbol">;</a> <a id="1878" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">_‚ä¢_‚Üì_</a><a id="1883" class="Symbol">;</a> <a id="1885" href="plfa.part3.Denotational.html#7361" class="Function Operator">_`,_</a><a id="1889" class="Symbol">;</a> <a id="1891" href="plfa.part3.Denotational.html#4424" class="Datatype Operator">_‚äë_</a><a id="1894" class="Symbol">;</a> <a id="1896" href="plfa.part3.Denotational.html#8024" class="Function Operator">_`‚äë_</a><a id="1900" class="Symbol">;</a> <a id="1902" href="plfa.part3.Denotational.html#8227" class="Function">`‚ä•</a><a id="1904" class="Symbol">;</a> <a id="1906" href="plfa.part3.Denotational.html#8256" class="Function Operator">_`‚äî_</a><a id="1910" class="Symbol">;</a> <a id="1912" href="plfa.part3.Denotational.html#7602" class="Function">init</a><a id="1916" class="Symbol">;</a> <a id="1918" href="plfa.part3.Denotational.html#7657" class="Function">last</a><a id="1922" class="Symbol">;</a> <a id="1924" href="plfa.part3.Denotational.html#7706" class="Function">init-last</a><a id="1933" class="Symbol">;</a>
            <a id="1947" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#5554" class="Function">‚äë-refl</a><a id="1953" class="Symbol">;</a> <a id="1955" href="plfa.part3.Denotational.html#4714" class="InductiveConstructor">‚äë-trans</a><a id="1962" class="Symbol">;</a> <a id="1964" href="plfa.part3.Denotational.html#8515" class="Function">`‚äë-refl</a><a id="1971" class="Symbol">;</a> <a id="1973" href="plfa.part3.Denotational.html#25631" class="Function">‚äë-env</a><a id="1978" class="Symbol">;</a> <a id="1980" href="plfa.part3.Denotational.html#8586" class="Function">‚äë-env-conj-R1</a><a id="1993" class="Symbol">;</a> <a id="1995" href="plfa.part3.Denotational.html#8692" class="Function">‚äë-env-conj-R2</a><a id="2008" class="Symbol">;</a> <a id="2010" href="plfa.part3.Denotational.html#26062" class="Function">up-env</a><a id="2016" class="Symbol">;</a>
            <a id="2030" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a><a id="2033" class="Symbol">;</a> <a id="2035" href="plfa.part3.Denotational.html#9391" class="InductiveConstructor">‚Ü¶-elim</a><a id="2041" class="Symbol">;</a> <a id="2043" href="plfa.part3.Denotational.html#9513" class="InductiveConstructor">‚Ü¶-intro</a><a id="2050" class="Symbol">;</a> <a id="2052" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a><a id="2059" class="Symbol">;</a> <a id="2061" href="plfa.part3.Denotational.html#9692" class="InductiveConstructor">‚äî-intro</a><a id="2068" class="Symbol">;</a> <a id="2070" href="plfa.part3.Denotational.html#9807" class="InductiveConstructor">sub</a><a id="2073" class="Symbol">;</a>
            <a id="2087" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#24051" class="Function">rename-pres</a><a id="2098" class="Symbol">;</a> <a id="2100" href="plfa.part3.Denotational.html#17393" class="Function">‚Ñ∞</a><a id="2101" class="Symbol">;</a> <a id="2103" href="plfa.part3.Denotational.html#17575" class="Function Operator">_‚âÉ_</a><a id="2106" class="Symbol">;</a> <a id="2108" href="plfa.part3.Denotational.html#17980" class="Function">‚âÉ-trans</a><a id="2115" class="Symbol">)</a>
<a id="2117" class="Keyword">open</a> <a id="2122" class="Keyword">import</a> <a id="2129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Compositional.md %}{% raw %}" class="Module">plfa.part3.Compositional</a> <a id="2154" class="Keyword">using</a> <a id="2160" class="Symbol">(</a><a id="2161" href="plfa.part3.Compositional.html#3841" class="Function">lambda-inversion</a><a id="2177" class="Symbol">;</a> <a id="2179" href="plfa.part3.Compositional.html#10031" class="Function">var-inv</a><a id="2186" class="Symbol">)</a>
</pre>{% endraw %}
## Forward reduction preserves denotations

The proof of preservation in this section mixes techniques from
previous chapters. Like the proof of preservation for the STLC, we are
preserving a relation defined separately from the syntax, in contrast
to the intrinsically-typed terms. On the other hand, we are using de
Bruijn indices for variables.

The outline of the proof remains the same in that we must prove lemmas
concerning all of the auxiliary functions used in the reduction
relation: substitution, renaming, and extension.


### Simultaneous substitution preserves denotations

Our next goal is to prove that simultaneous substitution preserves
meaning.  That is, if `M` results in `v` in environment `Œ≥`, then applying a
substitution `œÉ` to `M` gives us a program that also results in `v`, but in
an environment `Œ¥` in which, for every variable `x`, `œÉ x` results in the
same value as the one for `x` in the original environment `Œ≥`.
We write `Œ¥ ‚ä¢ œÉ ‚Üì Œ≥` for this condition.

{% raw %}<pre class="Agda"><a id="3184" class="Keyword">infix</a> <a id="3190" class="Number">3</a> <a id="3192" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3199" class="Function Operator">_`‚ä¢_‚Üì_</a>
<a id="_`‚ä¢_‚Üì_"></a><a id="3199" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3199" class="Function Operator">_`‚ä¢_‚Üì_</a> <a id="3206" class="Symbol">:</a> <a id="3208" class="Symbol">‚àÄ{</a><a id="3210" href="plfa.part3.Soundness.html#3210" class="Bound">Œî</a> <a id="3212" href="plfa.part3.Soundness.html#3212" class="Bound">Œì</a><a id="3213" class="Symbol">}</a> <a id="3215" class="Symbol">‚Üí</a> <a id="3217" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="3221" href="plfa.part3.Soundness.html#3210" class="Bound">Œî</a> <a id="3223" class="Symbol">‚Üí</a> <a id="3225" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="3231" href="plfa.part3.Soundness.html#3212" class="Bound">Œì</a> <a id="3233" href="plfa.part3.Soundness.html#3210" class="Bound">Œî</a> <a id="3235" class="Symbol">‚Üí</a> <a id="3237" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="3241" href="plfa.part3.Soundness.html#3212" class="Bound">Œì</a> <a id="3243" class="Symbol">‚Üí</a> <a id="3245" class="PrimitiveType">Set</a>
<a id="3249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3199" class="Function Operator">_`‚ä¢_‚Üì_</a> <a id="3256" class="Symbol">{</a><a id="3257" href="plfa.part3.Soundness.html#3257" class="Bound">Œî</a><a id="3258" class="Symbol">}{</a><a id="3260" href="plfa.part3.Soundness.html#3260" class="Bound">Œì</a><a id="3261" class="Symbol">}</a> <a id="3263" href="plfa.part3.Soundness.html#3263" class="Bound">Œ¥</a> <a id="3265" href="plfa.part3.Soundness.html#3265" class="Bound">œÉ</a> <a id="3267" href="plfa.part3.Soundness.html#3267" class="Bound">Œ≥</a> <a id="3269" class="Symbol">=</a> <a id="3271" class="Symbol">(‚àÄ</a> <a id="3274" class="Symbol">(</a><a id="3275" href="plfa.part3.Soundness.html#3275" class="Bound">x</a> <a id="3277" class="Symbol">:</a> <a id="3279" href="plfa.part3.Soundness.html#3260" class="Bound">Œì</a> <a id="3281" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="3283" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="3284" class="Symbol">)</a> <a id="3286" class="Symbol">‚Üí</a> <a id="3288" href="plfa.part3.Soundness.html#3263" class="Bound">Œ¥</a> <a id="3290" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="3292" href="plfa.part3.Soundness.html#3265" class="Bound">œÉ</a> <a id="3294" href="plfa.part3.Soundness.html#3275" class="Bound">x</a> <a id="3296" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="3298" href="plfa.part3.Soundness.html#3267" class="Bound">Œ≥</a> <a id="3300" href="plfa.part3.Soundness.html#3275" class="Bound">x</a><a id="3301" class="Symbol">)</a>
</pre>{% endraw %}
As usual, to prepare for lambda abstraction, we prove an extension
lemma. It says that applying the `exts` function to a substitution
produces a new substitution that maps variables to terms that when
evaluated in `Œ¥ , v` produce the values in `Œ≥ , v`.

{% raw %}<pre class="Agda"><a id="subst-ext"></a><a id="3566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3566" class="Function">subst-ext</a> <a id="3576" class="Symbol">:</a> <a id="3578" class="Symbol">‚àÄ</a> <a id="3580" class="Symbol">{</a><a id="3581" href="plfa.part3.Soundness.html#3581" class="Bound">Œì</a> <a id="3583" href="plfa.part3.Soundness.html#3583" class="Bound">Œî</a> <a id="3585" href="plfa.part3.Soundness.html#3585" class="Bound">v</a><a id="3586" class="Symbol">}</a> <a id="3588" class="Symbol">{</a><a id="3589" href="plfa.part3.Soundness.html#3589" class="Bound">Œ≥</a> <a id="3591" class="Symbol">:</a> <a id="3593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="3597" href="plfa.part3.Soundness.html#3581" class="Bound">Œì</a><a id="3598" class="Symbol">}</a> <a id="3600" class="Symbol">{</a><a id="3601" href="plfa.part3.Soundness.html#3601" class="Bound">Œ¥</a> <a id="3603" class="Symbol">:</a> <a id="3605" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="3609" href="plfa.part3.Soundness.html#3583" class="Bound">Œî</a><a id="3610" class="Symbol">}</a>
  <a id="3614" class="Symbol">‚Üí</a> <a id="3616" class="Symbol">(</a><a id="3617" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3617" class="Bound">œÉ</a> <a id="3619" class="Symbol">:</a> <a id="3621" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="3627" href="plfa.part3.Soundness.html#3581" class="Bound">Œì</a> <a id="3629" href="plfa.part3.Soundness.html#3583" class="Bound">Œî</a><a id="3630" class="Symbol">)</a>
  <a id="3634" class="Symbol">‚Üí</a> <a id="3636" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3601" class="Bound">Œ¥</a> <a id="3638" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="3641" href="plfa.part3.Soundness.html#3617" class="Bound">œÉ</a> <a id="3643" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="3645" href="plfa.part3.Soundness.html#3589" class="Bound">Œ≥</a>
   <a id="3650" class="Comment">--------------------------</a>
  <a id="3679" class="Symbol">‚Üí</a> <a id="3681" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3601" class="Bound">Œ¥</a> <a id="3683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7361" class="Function Operator">`,</a> <a id="3686" href="plfa.part3.Soundness.html#3585" class="Bound">v</a> <a id="3688" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="3691" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="3696" href="plfa.part3.Soundness.html#3617" class="Bound">œÉ</a> <a id="3698" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="3700" href="plfa.part3.Soundness.html#3589" class="Bound">Œ≥</a> <a id="3702" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="3705" href="plfa.part3.Soundness.html#3585" class="Bound">v</a>
<a id="3707" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3566" class="Function">subst-ext</a> <a id="3717" href="plfa.part3.Soundness.html#3717" class="Bound">œÉ</a> <a id="3719" href="plfa.part3.Soundness.html#3719" class="Bound">d</a> <a id="3721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="3723" class="Symbol">=</a> <a id="3725" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a>
<a id="3729" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#3566" class="Function">subst-ext</a> <a id="3739" href="plfa.part3.Soundness.html#3739" class="Bound">œÉ</a> <a id="3741" href="plfa.part3.Soundness.html#3741" class="Bound">d</a> <a id="3743" class="Symbol">(</a><a id="3744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="3746" href="plfa.part3.Soundness.html#3746" class="Bound">x‚Ä≤</a><a id="3748" class="Symbol">)</a> <a id="3750" class="Symbol">=</a> <a id="3752" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#24051" class="Function">rename-pres</a> <a id="3764" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S_</a> <a id="3767" class="Symbol">(Œª</a> <a id="3770" href="plfa.part3.Soundness.html#3770" class="Bound">_</a> <a id="3772" class="Symbol">‚Üí</a> <a id="3774" href="plfa.part3.Denotational.html#5554" class="Function">‚äë-refl</a><a id="3780" class="Symbol">)</a> <a id="3782" class="Symbol">(</a><a id="3783" href="plfa.part3.Soundness.html#3741" class="Bound">d</a> <a id="3785" href="plfa.part3.Soundness.html#3746" class="Bound">x‚Ä≤</a><a id="3787" class="Symbol">)</a>
</pre>{% endraw %}
The proof is by cases on the de Bruijn index `x`.

* If it is `Z`, then we need to show that `Œ¥ , v ‚ä¢ # 0 ‚Üì v`,
  which we have by rule `var`.

* If it is `S x‚Ä≤`,then we need to show that
  `Œ¥ , v ‚ä¢ rename S_ (œÉ x‚Ä≤) ‚Üì Œ≥ x‚Ä≤`,
  which we obtain by the `rename-pres` lemma.

With the extension lemma in hand, the proof that simultaneous
substitution preserves meaning is straightforward.  Let's dive in!

{% raw %}<pre class="Agda"><a id="subst-pres"></a><a id="4200" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4211" class="Symbol">:</a> <a id="4213" class="Symbol">‚àÄ</a> <a id="4215" class="Symbol">{</a><a id="4216" href="plfa.part3.Soundness.html#4216" class="Bound">Œì</a> <a id="4218" href="plfa.part3.Soundness.html#4218" class="Bound">Œî</a> <a id="4220" href="plfa.part3.Soundness.html#4220" class="Bound">v</a><a id="4221" class="Symbol">}</a> <a id="4223" class="Symbol">{</a><a id="4224" href="plfa.part3.Soundness.html#4224" class="Bound">Œ≥</a> <a id="4226" class="Symbol">:</a> <a id="4228" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="4232" href="plfa.part3.Soundness.html#4216" class="Bound">Œì</a><a id="4233" class="Symbol">}</a> <a id="4235" class="Symbol">{</a><a id="4236" href="plfa.part3.Soundness.html#4236" class="Bound">Œ¥</a> <a id="4238" class="Symbol">:</a> <a id="4240" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="4244" href="plfa.part3.Soundness.html#4218" class="Bound">Œî</a><a id="4245" class="Symbol">}</a> <a id="4247" class="Symbol">{</a><a id="4248" href="plfa.part3.Soundness.html#4248" class="Bound">M</a> <a id="4250" class="Symbol">:</a> <a id="4252" href="plfa.part3.Soundness.html#4216" class="Bound">Œì</a> <a id="4254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="4256" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="4257" class="Symbol">}</a>
  <a id="4261" class="Symbol">‚Üí</a> <a id="4263" class="Symbol">(</a><a id="4264" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4264" class="Bound">œÉ</a> <a id="4266" class="Symbol">:</a> <a id="4268" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="4274" href="plfa.part3.Soundness.html#4216" class="Bound">Œì</a> <a id="4276" href="plfa.part3.Soundness.html#4218" class="Bound">Œî</a><a id="4277" class="Symbol">)</a>
  <a id="4281" class="Symbol">‚Üí</a> <a id="4283" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4236" class="Bound">Œ¥</a> <a id="4285" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="4288" href="plfa.part3.Soundness.html#4264" class="Bound">œÉ</a> <a id="4290" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="4292" href="plfa.part3.Soundness.html#4224" class="Bound">Œ≥</a>
  <a id="4296" class="Symbol">‚Üí</a> <a id="4298" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4224" class="Bound">Œ≥</a> <a id="4300" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="4302" href="plfa.part3.Soundness.html#4248" class="Bound">M</a> <a id="4304" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="4306" href="plfa.part3.Soundness.html#4220" class="Bound">v</a>
    <a id="4312" class="Comment">------------------</a>
  <a id="4333" class="Symbol">‚Üí</a> <a id="4335" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4236" class="Bound">Œ¥</a> <a id="4337" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="4339" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="4345" href="plfa.part3.Soundness.html#4264" class="Bound">œÉ</a> <a id="4347" href="plfa.part3.Soundness.html#4248" class="Bound">M</a> <a id="4349" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="4351" href="plfa.part3.Soundness.html#4220" class="Bound">v</a>
<a id="4353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4364" href="plfa.part3.Soundness.html#4364" class="Bound">œÉ</a> <a id="4366" href="plfa.part3.Soundness.html#4366" class="Bound">s</a> <a id="4368" class="Symbol">(</a><a id="4369" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="4373" class="Symbol">{</a><a id="4374" class="Argument">x</a> <a id="4376" class="Symbol">=</a> <a id="4378" href="plfa.part3.Soundness.html#4378" class="Bound">x</a><a id="4379" class="Symbol">})</a> <a id="4382" class="Symbol">=</a> <a id="4384" class="Symbol">(</a><a id="4385" href="plfa.part3.Soundness.html#4366" class="Bound">s</a> <a id="4387" href="plfa.part3.Soundness.html#4378" class="Bound">x</a><a id="4388" class="Symbol">)</a>
<a id="4390" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4401" href="plfa.part3.Soundness.html#4401" class="Bound">œÉ</a> <a id="4403" href="plfa.part3.Soundness.html#4403" class="Bound">s</a> <a id="4405" class="Symbol">(</a><a id="4406" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="4413" href="plfa.part3.Soundness.html#4413" class="Bound">d‚ÇÅ</a> <a id="4416" href="plfa.part3.Soundness.html#4416" class="Bound">d‚ÇÇ</a><a id="4418" class="Symbol">)</a> <a id="4420" class="Symbol">=</a>
  <a id="4424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="4431" class="Symbol">(</a><a id="4432" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4443" href="plfa.part3.Soundness.html#4401" class="Bound">œÉ</a> <a id="4445" href="plfa.part3.Soundness.html#4403" class="Bound">s</a> <a id="4447" href="plfa.part3.Soundness.html#4413" class="Bound">d‚ÇÅ</a><a id="4449" class="Symbol">)</a> <a id="4451" class="Symbol">(</a><a id="4452" href="plfa.part3.Soundness.html#4200" class="Function">subst-pres</a> <a id="4463" href="plfa.part3.Soundness.html#4401" class="Bound">œÉ</a> <a id="4465" href="plfa.part3.Soundness.html#4403" class="Bound">s</a> <a id="4467" href="plfa.part3.Soundness.html#4416" class="Bound">d‚ÇÇ</a><a id="4469" class="Symbol">)</a>
<a id="4471" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4482" href="plfa.part3.Soundness.html#4482" class="Bound">œÉ</a> <a id="4484" href="plfa.part3.Soundness.html#4484" class="Bound">s</a> <a id="4486" class="Symbol">(</a><a id="4487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="4495" href="plfa.part3.Soundness.html#4495" class="Bound">d</a><a id="4496" class="Symbol">)</a> <a id="4498" class="Symbol">=</a>
  <a id="4502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="4510" class="Symbol">(</a><a id="4511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4522" class="Symbol">(Œª</a> <a id="4525" class="Symbol">{</a><a id="4526" href="plfa.part3.Soundness.html#4526" class="Bound">A</a><a id="4527" class="Symbol">}</a> <a id="4529" class="Symbol">‚Üí</a> <a id="4531" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="4536" href="plfa.part3.Soundness.html#4482" class="Bound">œÉ</a><a id="4537" class="Symbol">)</a> <a id="4539" class="Symbol">(</a><a id="4540" href="plfa.part3.Soundness.html#3566" class="Function">subst-ext</a> <a id="4550" href="plfa.part3.Soundness.html#4482" class="Bound">œÉ</a> <a id="4552" href="plfa.part3.Soundness.html#4484" class="Bound">s</a><a id="4553" class="Symbol">)</a> <a id="4555" href="plfa.part3.Soundness.html#4495" class="Bound">d</a><a id="4556" class="Symbol">)</a>
<a id="4558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4569" href="plfa.part3.Soundness.html#4569" class="Bound">œÉ</a> <a id="4571" href="plfa.part3.Soundness.html#4571" class="Bound">s</a> <a id="4573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="4581" class="Symbol">=</a> <a id="4583" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a>
<a id="4591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4602" href="plfa.part3.Soundness.html#4602" class="Bound">œÉ</a> <a id="4604" href="plfa.part3.Soundness.html#4604" class="Bound">s</a> <a id="4606" class="Symbol">(</a><a id="4607" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="4615" href="plfa.part3.Soundness.html#4615" class="Bound">d‚ÇÅ</a> <a id="4618" href="plfa.part3.Soundness.html#4618" class="Bound">d‚ÇÇ</a><a id="4620" class="Symbol">)</a> <a id="4622" class="Symbol">=</a>
  <a id="4626" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="4634" class="Symbol">(</a><a id="4635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4646" href="plfa.part3.Soundness.html#4602" class="Bound">œÉ</a> <a id="4648" href="plfa.part3.Soundness.html#4604" class="Bound">s</a> <a id="4650" href="plfa.part3.Soundness.html#4615" class="Bound">d‚ÇÅ</a><a id="4652" class="Symbol">)</a> <a id="4654" class="Symbol">(</a><a id="4655" href="plfa.part3.Soundness.html#4200" class="Function">subst-pres</a> <a id="4666" href="plfa.part3.Soundness.html#4602" class="Bound">œÉ</a> <a id="4668" href="plfa.part3.Soundness.html#4604" class="Bound">s</a> <a id="4670" href="plfa.part3.Soundness.html#4618" class="Bound">d‚ÇÇ</a><a id="4672" class="Symbol">)</a>
<a id="4674" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="4685" href="plfa.part3.Soundness.html#4685" class="Bound">œÉ</a> <a id="4687" href="plfa.part3.Soundness.html#4687" class="Bound">s</a> <a id="4689" class="Symbol">(</a><a id="4690" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="4694" href="plfa.part3.Soundness.html#4694" class="Bound">d</a> <a id="4696" href="plfa.part3.Soundness.html#4696" class="Bound">lt</a><a id="4698" class="Symbol">)</a> <a id="4700" class="Symbol">=</a> <a id="4702" href="plfa.part3.Denotational.html#9807" class="InductiveConstructor">sub</a> <a id="4706" class="Symbol">(</a><a id="4707" href="plfa.part3.Soundness.html#4200" class="Function">subst-pres</a> <a id="4718" href="plfa.part3.Soundness.html#4685" class="Bound">œÉ</a> <a id="4720" href="plfa.part3.Soundness.html#4687" class="Bound">s</a> <a id="4722" href="plfa.part3.Soundness.html#4694" class="Bound">d</a><a id="4723" class="Symbol">)</a> <a id="4725" href="plfa.part3.Soundness.html#4696" class="Bound">lt</a>
</pre>{% endraw %}
The proof is by induction on the semantics of `M`.  The two interesting
cases are for variables and lambda abstractions.

* For a variable `x`, we have that `v ‚äë Œ≥ x` and we need to show that
  `Œ¥ ‚ä¢ œÉ x ‚Üì v`.  From the premise applied to `x`, we have that
  `Œ¥ ‚ä¢ œÉ x ‚Üì Œ≥ x`, so we conclude by the `sub` rule.

* For a lambda abstraction, we must extend the substitution
  for the induction hypothesis. We apply the `subst-ext` lemma
  to show that the extended substitution maps variables to
  terms that result in the appropriate values.


### Single substitution preserves denotations

For Œ≤ reduction, `(∆õ N) ¬∑ M ‚Äî‚Üí N [ M ]`, we need to show that the
semantics is preserved when substituting `M` for de Bruijn index 0 in
term `N`. By inversion on the rules `‚Ü¶-elim` and `‚Ü¶-intro`,
we have that `Œ≥ , v ‚ä¢ M ‚Üì w` and `Œ≥ ‚ä¢ N ‚Üì v`.
So we need to show that `Œ≥ ‚ä¢ M [ N ] ‚Üì w`, or equivalently,
that `Œ≥ ‚ä¢ subst (subst-zero N) M ‚Üì w`.

{% raw %}<pre class="Agda"><a id="substitution"></a><a id="5667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5667" class="Function">substitution</a> <a id="5680" class="Symbol">:</a> <a id="5682" class="Symbol">‚àÄ</a> <a id="5684" class="Symbol">{</a><a id="5685" href="plfa.part3.Soundness.html#5685" class="Bound">Œì</a><a id="5686" class="Symbol">}</a> <a id="5688" class="Symbol">{</a><a id="5689" href="plfa.part3.Soundness.html#5689" class="Bound">Œ≥</a> <a id="5691" class="Symbol">:</a> <a id="5693" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="5697" href="plfa.part3.Soundness.html#5685" class="Bound">Œì</a><a id="5698" class="Symbol">}</a> <a id="5700" class="Symbol">{</a><a id="5701" href="plfa.part3.Soundness.html#5701" class="Bound">N</a> <a id="5703" href="plfa.part3.Soundness.html#5703" class="Bound">M</a> <a id="5705" href="plfa.part3.Soundness.html#5705" class="Bound">v</a> <a id="5707" href="plfa.part3.Soundness.html#5707" class="Bound">w</a><a id="5708" class="Symbol">}</a>
   <a id="5713" class="Symbol">‚Üí</a> <a id="5715" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5689" class="Bound">Œ≥</a> <a id="5717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7361" class="Function Operator">`,</a> <a id="5720" href="plfa.part3.Soundness.html#5705" class="Bound">v</a> <a id="5722" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="5724" href="plfa.part3.Soundness.html#5701" class="Bound">N</a> <a id="5726" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="5728" href="plfa.part3.Soundness.html#5707" class="Bound">w</a>
   <a id="5733" class="Symbol">‚Üí</a> <a id="5735" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5689" class="Bound">Œ≥</a> <a id="5737" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="5739" href="plfa.part3.Soundness.html#5703" class="Bound">M</a> <a id="5741" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="5743" href="plfa.part3.Soundness.html#5705" class="Bound">v</a>
     <a id="5750" class="Comment">---------------</a>
   <a id="5769" class="Symbol">‚Üí</a> <a id="5771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5689" class="Bound">Œ≥</a> <a id="5773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="5775" href="plfa.part3.Soundness.html#5701" class="Bound">N</a> <a id="5777" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="5779" href="plfa.part3.Soundness.html#5703" class="Bound">M</a> <a id="5781" href="plfa.part2.Untyped.html#7491" class="Function Operator">]</a> <a id="5783" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="5785" href="plfa.part3.Soundness.html#5707" class="Bound">w</a>
<a id="5787" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5667" class="Function">substitution</a><a id="5799" class="Symbol">{</a><a id="5800" href="plfa.part3.Soundness.html#5800" class="Bound">Œì</a><a id="5801" class="Symbol">}{</a><a id="5803" href="plfa.part3.Soundness.html#5803" class="Bound">Œ≥</a><a id="5804" class="Symbol">}{</a><a id="5806" href="plfa.part3.Soundness.html#5806" class="Bound">N</a><a id="5807" class="Symbol">}{</a><a id="5809" href="plfa.part3.Soundness.html#5809" class="Bound">M</a><a id="5810" class="Symbol">}{</a><a id="5812" href="plfa.part3.Soundness.html#5812" class="Bound">v</a><a id="5813" class="Symbol">}{</a><a id="5815" href="plfa.part3.Soundness.html#5815" class="Bound">w</a><a id="5816" class="Symbol">}</a> <a id="5818" href="plfa.part3.Soundness.html#5818" class="Bound">dn</a> <a id="5821" href="plfa.part3.Soundness.html#5821" class="Bound">dm</a> <a id="5824" class="Symbol">=</a>
  <a id="5828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#4200" class="Function">subst-pres</a> <a id="5839" class="Symbol">(</a><a id="5840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a> <a id="5851" href="plfa.part3.Soundness.html#5809" class="Bound">M</a><a id="5852" class="Symbol">)</a> <a id="5854" href="plfa.part3.Soundness.html#5876" class="Function">sub-z-ok</a> <a id="5863" href="plfa.part3.Soundness.html#5818" class="Bound">dn</a>
  <a id="5868" class="Keyword">where</a>
  <a id="5876" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5876" class="Function">sub-z-ok</a> <a id="5885" class="Symbol">:</a> <a id="5887" href="plfa.part3.Soundness.html#5803" class="Bound">Œ≥</a> <a id="5889" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="5892" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a> <a id="5903" href="plfa.part3.Soundness.html#5809" class="Bound">M</a> <a id="5905" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="5907" class="Symbol">(</a><a id="5908" href="plfa.part3.Soundness.html#5803" class="Bound">Œ≥</a> <a id="5910" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7361" class="Function Operator">`,</a> <a id="5913" href="plfa.part3.Soundness.html#5812" class="Bound">v</a><a id="5914" class="Symbol">)</a>
  <a id="5918" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5876" class="Function">sub-z-ok</a> <a id="5927" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="5929" class="Symbol">=</a> <a id="5931" href="plfa.part3.Soundness.html#5821" class="Bound">dm</a>
  <a id="5936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#5876" class="Function">sub-z-ok</a> <a id="5945" class="Symbol">(</a><a id="5946" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="5948" href="plfa.part3.Soundness.html#5948" class="Bound">x</a><a id="5949" class="Symbol">)</a> <a id="5951" class="Symbol">=</a> <a id="5953" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a>
</pre>{% endraw %}
This result is a corollary of the lemma for simultaneous substitution.
To use the lemma, we just need to show that `subst-zero M` maps
variables to terms that produces the same values as those in `Œ≥ , v`.
Let `y` be an arbitrary variable (de Bruijn index).

* If it is `Z`, then `(subst-zero M) y = M` and `(Œ≥ , v) y = v`.
  By the premise we conclude that `Œ≥ ‚ä¢ M ‚Üì v`.

* If it is `S x`, then `(subst-zero M) (S x) = x` and
  `(Œ≥ , v) (S x) = Œ≥ x`.  So we conclude that
  `Œ≥ ‚ä¢ x ‚Üì Œ≥ x` by rule `var`.


### Reduction preserves denotations

With the substitution lemma in hand, it is straightforward to prove
that reduction preserves denotations.

{% raw %}<pre class="Agda"><a id="preserve"></a><a id="6614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6623" class="Symbol">:</a> <a id="6625" class="Symbol">‚àÄ</a> <a id="6627" class="Symbol">{</a><a id="6628" href="plfa.part3.Soundness.html#6628" class="Bound">Œì</a><a id="6629" class="Symbol">}</a> <a id="6631" class="Symbol">{</a><a id="6632" href="plfa.part3.Soundness.html#6632" class="Bound">Œ≥</a> <a id="6634" class="Symbol">:</a> <a id="6636" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="6640" href="plfa.part3.Soundness.html#6628" class="Bound">Œì</a><a id="6641" class="Symbol">}</a> <a id="6643" class="Symbol">{</a><a id="6644" href="plfa.part3.Soundness.html#6644" class="Bound">M</a> <a id="6646" href="plfa.part3.Soundness.html#6646" class="Bound">N</a> <a id="6648" href="plfa.part3.Soundness.html#6648" class="Bound">v</a><a id="6649" class="Symbol">}</a>
  <a id="6653" class="Symbol">‚Üí</a> <a id="6655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6632" class="Bound">Œ≥</a> <a id="6657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="6659" href="plfa.part3.Soundness.html#6644" class="Bound">M</a> <a id="6661" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="6663" href="plfa.part3.Soundness.html#6648" class="Bound">v</a>
  <a id="6667" class="Symbol">‚Üí</a> <a id="6669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6644" class="Bound">M</a> <a id="6671" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">‚Äî‚Üí</a> <a id="6674" href="plfa.part3.Soundness.html#6646" class="Bound">N</a>
    <a id="6680" class="Comment">----------</a>
  <a id="6693" class="Symbol">‚Üí</a> <a id="6695" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6632" class="Bound">Œ≥</a> <a id="6697" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="6699" href="plfa.part3.Soundness.html#6646" class="Bound">N</a> <a id="6701" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="6703" href="plfa.part3.Soundness.html#6648" class="Bound">v</a>
<a id="6705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6714" class="Symbol">(</a><a id="6715" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a><a id="6718" class="Symbol">)</a> <a id="6720" class="Symbol">()</a>
<a id="6723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6732" class="Symbol">(</a><a id="6733" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="6740" href="plfa.part3.Soundness.html#6740" class="Bound">d‚ÇÅ</a> <a id="6743" href="plfa.part3.Soundness.html#6743" class="Bound">d‚ÇÇ</a><a id="6745" class="Symbol">)</a> <a id="6747" class="Symbol">(</a><a id="6748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Œæ‚ÇÅ</a> <a id="6751" href="plfa.part3.Soundness.html#6751" class="Bound">r</a><a id="6752" class="Symbol">)</a> <a id="6754" class="Symbol">=</a> <a id="6756" href="plfa.part3.Denotational.html#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="6763" class="Symbol">(</a><a id="6764" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="6773" href="plfa.part3.Soundness.html#6740" class="Bound">d‚ÇÅ</a> <a id="6776" href="plfa.part3.Soundness.html#6751" class="Bound">r</a><a id="6777" class="Symbol">)</a> <a id="6779" href="plfa.part3.Soundness.html#6743" class="Bound">d‚ÇÇ</a>
<a id="6782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6791" class="Symbol">(</a><a id="6792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="6799" href="plfa.part3.Soundness.html#6799" class="Bound">d‚ÇÅ</a> <a id="6802" href="plfa.part3.Soundness.html#6802" class="Bound">d‚ÇÇ</a><a id="6804" class="Symbol">)</a> <a id="6806" class="Symbol">(</a><a id="6807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Œæ‚ÇÇ</a> <a id="6810" href="plfa.part3.Soundness.html#6810" class="Bound">r</a><a id="6811" class="Symbol">)</a> <a id="6813" class="Symbol">=</a> <a id="6815" href="plfa.part3.Denotational.html#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="6822" href="plfa.part3.Soundness.html#6799" class="Bound">d‚ÇÅ</a> <a id="6825" class="Symbol">(</a><a id="6826" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="6835" href="plfa.part3.Soundness.html#6802" class="Bound">d‚ÇÇ</a> <a id="6838" href="plfa.part3.Soundness.html#6810" class="Bound">r</a><a id="6839" class="Symbol">)</a>
<a id="6841" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6850" class="Symbol">(</a><a id="6851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="6858" href="plfa.part3.Soundness.html#6858" class="Bound">d‚ÇÅ</a> <a id="6861" href="plfa.part3.Soundness.html#6861" class="Bound">d‚ÇÇ</a><a id="6863" class="Symbol">)</a> <a id="6865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Œ≤</a> <a id="6867" class="Symbol">=</a> <a id="6869" href="plfa.part3.Soundness.html#5667" class="Function">substitution</a> <a id="6882" class="Symbol">(</a><a id="6883" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Compositional.md %}{% raw %}#3841" class="Function">lambda-inversion</a> <a id="6900" href="plfa.part3.Soundness.html#6858" class="Bound">d‚ÇÅ</a><a id="6902" class="Symbol">)</a> <a id="6904" href="plfa.part3.Soundness.html#6861" class="Bound">d‚ÇÇ</a>
<a id="6907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6916" class="Symbol">(</a><a id="6917" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="6925" href="plfa.part3.Soundness.html#6925" class="Bound">d</a><a id="6926" class="Symbol">)</a> <a id="6928" class="Symbol">(</a><a id="6929" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Œ∂</a> <a id="6931" href="plfa.part3.Soundness.html#6931" class="Bound">r</a><a id="6932" class="Symbol">)</a> <a id="6934" class="Symbol">=</a> <a id="6936" href="plfa.part3.Denotational.html#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="6944" class="Symbol">(</a><a id="6945" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="6954" href="plfa.part3.Soundness.html#6925" class="Bound">d</a> <a id="6956" href="plfa.part3.Soundness.html#6931" class="Bound">r</a><a id="6957" class="Symbol">)</a>
<a id="6959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="6976" href="plfa.part3.Soundness.html#6976" class="Bound">r</a> <a id="6978" class="Symbol">=</a> <a id="6980" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a>
<a id="6988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="6997" class="Symbol">(</a><a id="6998" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="7006" href="plfa.part3.Soundness.html#7006" class="Bound">d</a> <a id="7008" href="plfa.part3.Soundness.html#7008" class="Bound">d‚ÇÅ</a><a id="7010" class="Symbol">)</a> <a id="7012" href="plfa.part3.Soundness.html#7012" class="Bound">r</a> <a id="7014" class="Symbol">=</a> <a id="7016" href="plfa.part3.Denotational.html#9692" class="InductiveConstructor">‚äî-intro</a> <a id="7024" class="Symbol">(</a><a id="7025" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="7034" href="plfa.part3.Soundness.html#7006" class="Bound">d</a> <a id="7036" href="plfa.part3.Soundness.html#7012" class="Bound">r</a><a id="7037" class="Symbol">)</a> <a id="7039" class="Symbol">(</a><a id="7040" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="7049" href="plfa.part3.Soundness.html#7008" class="Bound">d‚ÇÅ</a> <a id="7052" href="plfa.part3.Soundness.html#7012" class="Bound">r</a><a id="7053" class="Symbol">)</a>
<a id="7055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#6614" class="Function">preserve</a> <a id="7064" class="Symbol">(</a><a id="7065" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="7069" href="plfa.part3.Soundness.html#7069" class="Bound">d</a> <a id="7071" href="plfa.part3.Soundness.html#7071" class="Bound">lt</a><a id="7073" class="Symbol">)</a> <a id="7075" href="plfa.part3.Soundness.html#7075" class="Bound">r</a> <a id="7077" class="Symbol">=</a> <a id="7079" href="plfa.part3.Denotational.html#9807" class="InductiveConstructor">sub</a> <a id="7083" class="Symbol">(</a><a id="7084" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="7093" href="plfa.part3.Soundness.html#7069" class="Bound">d</a> <a id="7095" href="plfa.part3.Soundness.html#7075" class="Bound">r</a><a id="7096" class="Symbol">)</a> <a id="7098" href="plfa.part3.Soundness.html#7071" class="Bound">lt</a>
</pre>{% endraw %}
We proceed by induction on the semantics of `M` with case analysis on
the reduction.

* If `M` is a variable, then there is no such reduction.

* If `M` is an application, then the reduction is either a congruence
  (Œæ‚ÇÅ or Œæ‚ÇÇ) or Œ≤. For each congruence, we use the induction
  hypothesis. For Œ≤ reduction we use the substitution lemma and the
  `sub` rule.

* The rest of the cases are straightforward.

## Reduction reflects denotations

This section proves that reduction reflects the denotation of a
term. That is, if `N` results in `v`, and if `M` reduces to `N`, then
`M` also results in `v`. While there are some broad similarities
between this proof and the above proof of semantic preservation, we
shall require a few more technical lemmas to obtain this result.

The main challenge is dealing with the substitution in Œ≤ reduction:

    (∆õ N) ¬∑ M ‚Äî‚Üí N [ M ]

We have that `Œ≥ ‚ä¢ N [ M ] ‚Üì v` and need to show that
`Œ≥ ‚ä¢ (∆õ N) ¬∑ M ‚Üì v`. Now consider the derivation of `Œ≥ ‚ä¢ N [ M ] ‚Üì v`.
The term `M` may occur 0, 1, or many times inside `N [ M ]`. At each of
those occurences, `M` may result in a different value. But to build a
derivation for `(∆õ N) ¬∑ M`, we need a single value for `M`.  If `M`
occured more than 1 time, then we can join all of the different values
using `‚äî`. If `M` occured 0 times, then we do not need any information
about `M` and can therefore use `‚ä•` for the value of `M`.


### Renaming reflects meaning

Previously we showed that renaming variables preserves meaning.  Now
we prove the opposite, that it reflects meaning. That is,
if `Œ¥ ‚ä¢ rename œÅ M ‚Üì v`, then `Œ≥ ‚ä¢ M ‚Üì v`, where `(Œ¥ ‚àò œÅ) `‚äë Œ≥`.

First, we need a variant of a lemma given earlier.
{% raw %}<pre class="Agda"><a id="ext-‚äë‚Ä≤"></a><a id="8788" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8788" class="Function">ext-‚äë‚Ä≤</a> <a id="8795" class="Symbol">:</a> <a id="8797" class="Symbol">‚àÄ</a> <a id="8799" class="Symbol">{</a><a id="8800" href="plfa.part3.Soundness.html#8800" class="Bound">Œì</a> <a id="8802" href="plfa.part3.Soundness.html#8802" class="Bound">Œî</a> <a id="8804" href="plfa.part3.Soundness.html#8804" class="Bound">v</a><a id="8805" class="Symbol">}</a> <a id="8807" class="Symbol">{</a><a id="8808" href="plfa.part3.Soundness.html#8808" class="Bound">Œ≥</a> <a id="8810" class="Symbol">:</a> <a id="8812" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="8816" href="plfa.part3.Soundness.html#8800" class="Bound">Œì</a><a id="8817" class="Symbol">}</a> <a id="8819" class="Symbol">{</a><a id="8820" href="plfa.part3.Soundness.html#8820" class="Bound">Œ¥</a> <a id="8822" class="Symbol">:</a> <a id="8824" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="8828" href="plfa.part3.Soundness.html#8802" class="Bound">Œî</a><a id="8829" class="Symbol">}</a>
  <a id="8833" class="Symbol">‚Üí</a> <a id="8835" class="Symbol">(</a><a id="8836" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8836" class="Bound">œÅ</a> <a id="8838" class="Symbol">:</a> <a id="8840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2192" class="Function">Rename</a> <a id="8847" href="plfa.part3.Soundness.html#8800" class="Bound">Œì</a> <a id="8849" href="plfa.part3.Soundness.html#8802" class="Bound">Œî</a><a id="8850" class="Symbol">)</a>
  <a id="8854" class="Symbol">‚Üí</a> <a id="8856" class="Symbol">(</a><a id="8857" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8820" class="Bound">Œ¥</a> <a id="8859" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">‚àò</a> <a id="8861" href="plfa.part3.Soundness.html#8836" class="Bound">œÅ</a><a id="8862" class="Symbol">)</a> <a id="8864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8024" class="Function Operator">`‚äë</a> <a id="8867" href="plfa.part3.Soundness.html#8808" class="Bound">Œ≥</a>
    <a id="8873" class="Comment">------------------------------</a>
  <a id="8906" class="Symbol">‚Üí</a> <a id="8908" class="Symbol">((</a><a id="8910" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8820" class="Bound">Œ¥</a> <a id="8912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7361" class="Function Operator">`,</a> <a id="8915" href="plfa.part3.Soundness.html#8804" class="Bound">v</a><a id="8916" class="Symbol">)</a> <a id="8918" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">‚àò</a> <a id="8920" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#5925" class="Function">ext</a> <a id="8924" href="plfa.part3.Soundness.html#8836" class="Bound">œÅ</a><a id="8925" class="Symbol">)</a> <a id="8927" href="plfa.part3.Denotational.html#8024" class="Function Operator">`‚äë</a> <a id="8930" class="Symbol">(</a><a id="8931" href="plfa.part3.Soundness.html#8808" class="Bound">Œ≥</a> <a id="8933" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="8936" href="plfa.part3.Soundness.html#8804" class="Bound">v</a><a id="8937" class="Symbol">)</a>
<a id="8939" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8788" class="Function">ext-‚äë‚Ä≤</a> <a id="8946" href="plfa.part3.Soundness.html#8946" class="Bound">œÅ</a> <a id="8948" href="plfa.part3.Soundness.html#8948" class="Bound">lt</a> <a id="8951" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="8953" class="Symbol">=</a> <a id="8955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#5554" class="Function">‚äë-refl</a>
<a id="8962" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#8788" class="Function">ext-‚äë‚Ä≤</a> <a id="8969" href="plfa.part3.Soundness.html#8969" class="Bound">œÅ</a> <a id="8971" href="plfa.part3.Soundness.html#8971" class="Bound">lt</a> <a id="8974" class="Symbol">(</a><a id="8975" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="8977" href="plfa.part3.Soundness.html#8977" class="Bound">x</a><a id="8978" class="Symbol">)</a> <a id="8980" class="Symbol">=</a> <a id="8982" href="plfa.part3.Soundness.html#8971" class="Bound">lt</a> <a id="8985" href="plfa.part3.Soundness.html#8977" class="Bound">x</a>
</pre>{% endraw %}
The proof is then as follows.
{% raw %}<pre class="Agda"><a id="rename-reflect"></a><a id="9026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9041" class="Symbol">:</a> <a id="9043" class="Symbol">‚àÄ</a> <a id="9045" class="Symbol">{</a><a id="9046" href="plfa.part3.Soundness.html#9046" class="Bound">Œì</a> <a id="9048" href="plfa.part3.Soundness.html#9048" class="Bound">Œî</a> <a id="9050" href="plfa.part3.Soundness.html#9050" class="Bound">v</a><a id="9051" class="Symbol">}</a> <a id="9053" class="Symbol">{</a><a id="9054" href="plfa.part3.Soundness.html#9054" class="Bound">Œ≥</a> <a id="9056" class="Symbol">:</a> <a id="9058" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="9062" href="plfa.part3.Soundness.html#9046" class="Bound">Œì</a><a id="9063" class="Symbol">}</a> <a id="9065" class="Symbol">{</a><a id="9066" href="plfa.part3.Soundness.html#9066" class="Bound">Œ¥</a> <a id="9068" class="Symbol">:</a> <a id="9070" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="9074" href="plfa.part3.Soundness.html#9048" class="Bound">Œî</a><a id="9075" class="Symbol">}</a> <a id="9077" class="Symbol">{</a> <a id="9079" href="plfa.part3.Soundness.html#9079" class="Bound">M</a> <a id="9081" class="Symbol">:</a> <a id="9083" href="plfa.part3.Soundness.html#9046" class="Bound">Œì</a> <a id="9085" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="9087" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="9088" class="Symbol">}</a>
  <a id="9092" class="Symbol">‚Üí</a> <a id="9094" class="Symbol">{</a><a id="9095" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9095" class="Bound">œÅ</a> <a id="9097" class="Symbol">:</a> <a id="9099" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2192" class="Function">Rename</a> <a id="9106" href="plfa.part3.Soundness.html#9046" class="Bound">Œì</a> <a id="9108" href="plfa.part3.Soundness.html#9048" class="Bound">Œî</a><a id="9109" class="Symbol">}</a>
  <a id="9113" class="Symbol">‚Üí</a> <a id="9115" class="Symbol">(</a><a id="9116" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9066" class="Bound">Œ¥</a> <a id="9118" href="https://agda.github.io/agda-stdlib/v1.1/Function.html#1099" class="Function Operator">‚àò</a> <a id="9120" href="plfa.part3.Soundness.html#9095" class="Bound">œÅ</a><a id="9121" class="Symbol">)</a> <a id="9123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8024" class="Function Operator">`‚äë</a> <a id="9126" href="plfa.part3.Soundness.html#9054" class="Bound">Œ≥</a>
  <a id="9130" class="Symbol">‚Üí</a> <a id="9132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9066" class="Bound">Œ¥</a> <a id="9134" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="9136" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="9143" href="plfa.part3.Soundness.html#9095" class="Bound">œÅ</a> <a id="9145" href="plfa.part3.Soundness.html#9079" class="Bound">M</a> <a id="9147" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="9149" href="plfa.part3.Soundness.html#9050" class="Bound">v</a>
    <a id="9155" class="Comment">------------------------------------</a>
  <a id="9194" class="Symbol">‚Üí</a> <a id="9196" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9054" class="Bound">Œ≥</a> <a id="9198" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="9200" href="plfa.part3.Soundness.html#9079" class="Bound">M</a> <a id="9202" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="9204" href="plfa.part3.Soundness.html#9050" class="Bound">v</a>
<a id="9206" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9221" class="Symbol">{</a><a id="9222" class="Argument">M</a> <a id="9224" class="Symbol">=</a> <a id="9226" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="9228" href="plfa.part3.Soundness.html#9228" class="Bound">x</a><a id="9229" class="Symbol">}</a> <a id="9231" href="plfa.part3.Soundness.html#9231" class="Bound">all-n</a> <a id="9237" href="plfa.part3.Soundness.html#9237" class="Bound">d</a> <a id="9239" class="Keyword">with</a> <a id="9244" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Compositional.md %}{% raw %}#10031" class="Function">var-inv</a> <a id="9252" href="plfa.part3.Soundness.html#9237" class="Bound">d</a>
<a id="9254" class="Symbol">...</a> <a id="9258" class="Symbol">|</a> <a id="9260" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9260" class="Bound">lt</a> <a id="9263" class="Symbol">=</a>  <a id="9266" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="9270" href="plfa.part3.Denotational.html#9316" class="InductiveConstructor">var</a> <a id="9274" class="Symbol">(</a><a id="9275" href="plfa.part3.Denotational.html#4714" class="InductiveConstructor">‚äë-trans</a> <a id="9283" href="plfa.part3.Soundness.html#9260" class="Bound">lt</a> <a id="9286" class="Symbol">(</a><a id="9287" class="Bound">all-n</a> <a id="9293" class="Bound">x</a><a id="9294" class="Symbol">))</a>
<a id="9297" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9312" class="Symbol">{</a><a id="9313" class="Argument">M</a> <a id="9315" class="Symbol">=</a> <a id="9317" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="9319" href="plfa.part3.Soundness.html#9319" class="Bound">N</a><a id="9320" class="Symbol">}{</a><a id="9322" class="Argument">œÅ</a> <a id="9324" class="Symbol">=</a> <a id="9326" href="plfa.part3.Soundness.html#9326" class="Bound">œÅ</a><a id="9327" class="Symbol">}</a> <a id="9329" href="plfa.part3.Soundness.html#9329" class="Bound">all-n</a> <a id="9335" class="Symbol">(</a><a id="9336" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="9344" href="plfa.part3.Soundness.html#9344" class="Bound">d</a><a id="9345" class="Symbol">)</a> <a id="9347" class="Symbol">=</a>
   <a id="9352" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="9360" class="Symbol">(</a><a id="9361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9376" class="Symbol">(</a><a id="9377" href="plfa.part3.Soundness.html#8788" class="Function">ext-‚äë‚Ä≤</a> <a id="9384" href="plfa.part3.Soundness.html#9326" class="Bound">œÅ</a> <a id="9386" href="plfa.part3.Soundness.html#9329" class="Bound">all-n</a><a id="9391" class="Symbol">)</a> <a id="9393" href="plfa.part3.Soundness.html#9344" class="Bound">d</a><a id="9394" class="Symbol">)</a>
<a id="9396" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9411" class="Symbol">{</a><a id="9412" class="Argument">M</a> <a id="9414" class="Symbol">=</a> <a id="9416" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="9418" href="plfa.part3.Soundness.html#9418" class="Bound">N</a><a id="9419" class="Symbol">}</a> <a id="9421" href="plfa.part3.Soundness.html#9421" class="Bound">all-n</a> <a id="9427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="9435" class="Symbol">=</a> <a id="9437" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a>
<a id="9445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9460" class="Symbol">{</a><a id="9461" class="Argument">M</a> <a id="9463" class="Symbol">=</a> <a id="9465" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="9467" href="plfa.part3.Soundness.html#9467" class="Bound">N</a><a id="9468" class="Symbol">}</a> <a id="9470" href="plfa.part3.Soundness.html#9470" class="Bound">all-n</a> <a id="9476" class="Symbol">(</a><a id="9477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="9485" href="plfa.part3.Soundness.html#9485" class="Bound">d‚ÇÅ</a> <a id="9488" href="plfa.part3.Soundness.html#9488" class="Bound">d‚ÇÇ</a><a id="9490" class="Symbol">)</a> <a id="9492" class="Symbol">=</a>
   <a id="9497" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="9505" class="Symbol">(</a><a id="9506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9521" href="plfa.part3.Soundness.html#9470" class="Bound">all-n</a> <a id="9527" href="plfa.part3.Soundness.html#9485" class="Bound">d‚ÇÅ</a><a id="9529" class="Symbol">)</a> <a id="9531" class="Symbol">(</a><a id="9532" href="plfa.part3.Soundness.html#9026" class="Function">rename-reflect</a> <a id="9547" href="plfa.part3.Soundness.html#9470" class="Bound">all-n</a> <a id="9553" href="plfa.part3.Soundness.html#9488" class="Bound">d‚ÇÇ</a><a id="9555" class="Symbol">)</a>
<a id="9557" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9572" class="Symbol">{</a><a id="9573" class="Argument">M</a> <a id="9575" class="Symbol">=</a> <a id="9577" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="9579" href="plfa.part3.Soundness.html#9579" class="Bound">N</a><a id="9580" class="Symbol">}</a> <a id="9582" href="plfa.part3.Soundness.html#9582" class="Bound">all-n</a> <a id="9588" class="Symbol">(</a><a id="9589" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="9593" href="plfa.part3.Soundness.html#9593" class="Bound">d‚ÇÅ</a> <a id="9596" href="plfa.part3.Soundness.html#9596" class="Bound">lt</a><a id="9598" class="Symbol">)</a> <a id="9600" class="Symbol">=</a>
   <a id="9605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="9609" class="Symbol">(</a><a id="9610" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9625" href="plfa.part3.Soundness.html#9582" class="Bound">all-n</a> <a id="9631" href="plfa.part3.Soundness.html#9593" class="Bound">d‚ÇÅ</a><a id="9633" class="Symbol">)</a> <a id="9635" href="plfa.part3.Soundness.html#9596" class="Bound">lt</a>
<a id="9638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9653" class="Symbol">{</a><a id="9654" class="Argument">M</a> <a id="9656" class="Symbol">=</a> <a id="9658" href="plfa.part3.Soundness.html#9658" class="Bound">L</a> <a id="9660" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="9662" href="plfa.part3.Soundness.html#9662" class="Bound">M</a><a id="9663" class="Symbol">}</a> <a id="9665" href="plfa.part3.Soundness.html#9665" class="Bound">all-n</a> <a id="9671" class="Symbol">(</a><a id="9672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="9679" href="plfa.part3.Soundness.html#9679" class="Bound">d‚ÇÅ</a> <a id="9682" href="plfa.part3.Soundness.html#9682" class="Bound">d‚ÇÇ</a><a id="9684" class="Symbol">)</a> <a id="9686" class="Symbol">=</a>
   <a id="9691" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="9698" class="Symbol">(</a><a id="9699" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9714" href="plfa.part3.Soundness.html#9665" class="Bound">all-n</a> <a id="9720" href="plfa.part3.Soundness.html#9679" class="Bound">d‚ÇÅ</a><a id="9722" class="Symbol">)</a> <a id="9724" class="Symbol">(</a><a id="9725" href="plfa.part3.Soundness.html#9026" class="Function">rename-reflect</a> <a id="9740" href="plfa.part3.Soundness.html#9665" class="Bound">all-n</a> <a id="9746" href="plfa.part3.Soundness.html#9682" class="Bound">d‚ÇÇ</a><a id="9748" class="Symbol">)</a>
<a id="9750" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9765" class="Symbol">{</a><a id="9766" class="Argument">M</a> <a id="9768" class="Symbol">=</a> <a id="9770" href="plfa.part3.Soundness.html#9770" class="Bound">L</a> <a id="9772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="9774" href="plfa.part3.Soundness.html#9774" class="Bound">M</a><a id="9775" class="Symbol">}</a> <a id="9777" href="plfa.part3.Soundness.html#9777" class="Bound">all-n</a> <a id="9783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="9791" class="Symbol">=</a> <a id="9793" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a>
<a id="9801" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9816" class="Symbol">{</a><a id="9817" class="Argument">M</a> <a id="9819" class="Symbol">=</a> <a id="9821" href="plfa.part3.Soundness.html#9821" class="Bound">L</a> <a id="9823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="9825" href="plfa.part3.Soundness.html#9825" class="Bound">M</a><a id="9826" class="Symbol">}</a> <a id="9828" href="plfa.part3.Soundness.html#9828" class="Bound">all-n</a> <a id="9834" class="Symbol">(</a><a id="9835" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="9843" href="plfa.part3.Soundness.html#9843" class="Bound">d‚ÇÅ</a> <a id="9846" href="plfa.part3.Soundness.html#9846" class="Bound">d‚ÇÇ</a><a id="9848" class="Symbol">)</a> <a id="9850" class="Symbol">=</a>
   <a id="9855" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="9863" class="Symbol">(</a><a id="9864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9879" href="plfa.part3.Soundness.html#9828" class="Bound">all-n</a> <a id="9885" href="plfa.part3.Soundness.html#9843" class="Bound">d‚ÇÅ</a><a id="9887" class="Symbol">)</a> <a id="9889" class="Symbol">(</a><a id="9890" href="plfa.part3.Soundness.html#9026" class="Function">rename-reflect</a> <a id="9905" href="plfa.part3.Soundness.html#9828" class="Bound">all-n</a> <a id="9911" href="plfa.part3.Soundness.html#9846" class="Bound">d‚ÇÇ</a><a id="9913" class="Symbol">)</a>
<a id="9915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9930" class="Symbol">{</a><a id="9931" class="Argument">M</a> <a id="9933" class="Symbol">=</a> <a id="9935" href="plfa.part3.Soundness.html#9935" class="Bound">L</a> <a id="9937" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="9939" href="plfa.part3.Soundness.html#9939" class="Bound">M</a><a id="9940" class="Symbol">}</a> <a id="9942" href="plfa.part3.Soundness.html#9942" class="Bound">all-n</a> <a id="9948" class="Symbol">(</a><a id="9949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="9953" href="plfa.part3.Soundness.html#9953" class="Bound">d‚ÇÅ</a> <a id="9956" href="plfa.part3.Soundness.html#9956" class="Bound">lt</a><a id="9958" class="Symbol">)</a> <a id="9960" class="Symbol">=</a>
   <a id="9965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="9969" class="Symbol">(</a><a id="9970" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#9026" class="Function">rename-reflect</a> <a id="9985" href="plfa.part3.Soundness.html#9942" class="Bound">all-n</a> <a id="9991" href="plfa.part3.Soundness.html#9953" class="Bound">d‚ÇÅ</a><a id="9993" class="Symbol">)</a> <a id="9995" href="plfa.part3.Soundness.html#9956" class="Bound">lt</a>
</pre>{% endraw %}
We cannot prove this lemma by induction on the derivation of
`Œ¥ ‚ä¢ rename œÅ M ‚Üì v`, so instead we proceed by induction on `M`.

* If it is a variable, we apply the inversion lemma to obtain
  that `v ‚äë Œ¥ (œÅ x)`. Instantiating the premise to `x` we have
  `Œ¥ (œÅ x) = Œ≥ x`, so we conclude by the `var` rule.

* If it is a lambda abstraction `∆õ N`, we have
  rename `œÅ (∆õ N) = ∆õ (rename (ext œÅ) N)`.
  We proceed by cases on `Œ¥ ‚ä¢ ∆õ (rename (ext œÅ) N) ‚Üì v`.

  * Rule `‚Ü¶-intro`: To satisfy the premise of the induction
    hypothesis, we prove that the renaming can be extended to be a
    mapping from `Œ≥ , v‚ÇÅ to Œ¥ , v‚ÇÅ`.

  * Rule `‚ä•-intro`: We simply apply `‚ä•-intro`.

  * Rule `‚äî-intro`: We apply the induction hypotheses and `‚äî-intro`.

  * Rule `sub`: We apply the induction hypothesis and `sub`.

* If it is an application `L ¬∑ M`, we have
  `rename œÅ (L ¬∑ M) = (rename œÅ L) ¬∑ (rename œÅ M)`.
  We proceed by cases on `Œ¥ ‚ä¢ (rename œÅ L) ¬∑ (rename œÅ M) ‚Üì v`
  and all the cases are straightforward.

In the upcoming uses of `rename-reflect`, the renaming will always be
the increment function. So we prove a corollary for that special case.

{% raw %}<pre class="Agda"><a id="rename-inc-reflect"></a><a id="11148" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#11148" class="Function">rename-inc-reflect</a> <a id="11167" class="Symbol">:</a> <a id="11169" class="Symbol">‚àÄ</a> <a id="11171" class="Symbol">{</a><a id="11172" href="plfa.part3.Soundness.html#11172" class="Bound">Œì</a> <a id="11174" href="plfa.part3.Soundness.html#11174" class="Bound">v‚Ä≤</a> <a id="11177" href="plfa.part3.Soundness.html#11177" class="Bound">v</a><a id="11178" class="Symbol">}</a> <a id="11180" class="Symbol">{</a><a id="11181" href="plfa.part3.Soundness.html#11181" class="Bound">Œ≥</a> <a id="11183" class="Symbol">:</a> <a id="11185" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="11189" href="plfa.part3.Soundness.html#11172" class="Bound">Œì</a><a id="11190" class="Symbol">}</a> <a id="11192" class="Symbol">{</a> <a id="11194" href="plfa.part3.Soundness.html#11194" class="Bound">M</a> <a id="11196" class="Symbol">:</a> <a id="11198" href="plfa.part3.Soundness.html#11172" class="Bound">Œì</a> <a id="11200" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="11202" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="11203" class="Symbol">}</a>
  <a id="11207" class="Symbol">‚Üí</a> <a id="11209" class="Symbol">(</a><a id="11210" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#11181" class="Bound">Œ≥</a> <a id="11212" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7361" class="Function Operator">`,</a> <a id="11215" href="plfa.part3.Soundness.html#11174" class="Bound">v‚Ä≤</a><a id="11217" class="Symbol">)</a> <a id="11219" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="11221" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="11228" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S_</a> <a id="11231" href="plfa.part3.Soundness.html#11194" class="Bound">M</a> <a id="11233" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="11235" href="plfa.part3.Soundness.html#11177" class="Bound">v</a>
    <a id="11241" class="Comment">----------------------------</a>
  <a id="11272" class="Symbol">‚Üí</a> <a id="11274" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#11181" class="Bound">Œ≥</a> <a id="11276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="11278" href="plfa.part3.Soundness.html#11194" class="Bound">M</a> <a id="11280" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="11282" href="plfa.part3.Soundness.html#11177" class="Bound">v</a>
<a id="11284" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#11148" class="Function">rename-inc-reflect</a> <a id="11303" href="plfa.part3.Soundness.html#11303" class="Bound">d</a> <a id="11305" class="Symbol">=</a> <a id="11307" href="plfa.part3.Soundness.html#9026" class="Function">rename-reflect</a> <a id="11322" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8515" class="Function">`‚äë-refl</a> <a id="11330" href="plfa.part3.Soundness.html#11303" class="Bound">d</a>
</pre>{% endraw %}

### Substitution reflects denotations, the variable case

We are almost ready to begin proving that simultaneous substitution
reflects denotations. That is, if `Œ≥ ‚ä¢ (subst œÉ M) ‚Üì v`, then
`Œ≥ ‚ä¢ œÉ k ‚Üì Œ¥ k` and `Œ¥ ‚ä¢ M ‚Üì v` for any `k` and some `Œ¥`.
We shall start with the case in which `M` is a variable `x`.
So instead the premise is `Œ≥ ‚ä¢ œÉ x ‚Üì v` and we need to show that
`Œ¥ ‚ä¢ x ‚Üì v` for some `Œ¥`. The `Œ¥` that we choose shall be the
environment that maps `x` to `v` and every other variable to `‚ä•`.

Next we define the environment that maps `x` to `v` and every other
variable to `‚ä•`, that is `const-env x v`. To tell variables apart, we
define the following function for deciding equality of variables.

{% raw %}<pre class="Agda"><a id="_var‚âü_"></a><a id="12048" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12048" class="Function Operator">_var‚âü_</a> <a id="12055" class="Symbol">:</a> <a id="12057" class="Symbol">‚àÄ</a> <a id="12059" class="Symbol">{</a><a id="12060" href="plfa.part3.Soundness.html#12060" class="Bound">Œì</a><a id="12061" class="Symbol">}</a> <a id="12063" class="Symbol">‚Üí</a> <a id="12065" class="Symbol">(</a><a id="12066" href="plfa.part3.Soundness.html#12066" class="Bound">x</a> <a id="12068" href="plfa.part3.Soundness.html#12068" class="Bound">y</a> <a id="12070" class="Symbol">:</a> <a id="12072" href="plfa.part3.Soundness.html#12060" class="Bound">Œì</a> <a id="12074" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="12076" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="12077" class="Symbol">)</a> <a id="12079" class="Symbol">‚Üí</a> <a id="12081" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#605" class="Datatype">Dec</a> <a id="12085" class="Symbol">(</a><a id="12086" href="plfa.part3.Soundness.html#12066" class="Bound">x</a> <a id="12088" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="12090" href="plfa.part3.Soundness.html#12068" class="Bound">y</a><a id="12091" class="Symbol">)</a>
<a id="12093" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="12095" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12048" class="Function Operator">var‚âü</a> <a id="12100" href="plfa.part2.Untyped.html#3557" class="InductiveConstructor">Z</a>  <a id="12103" class="Symbol">=</a>  <a id="12106" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12110" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="12117" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12048" class="Function Operator">var‚âü</a> <a id="12122" class="Symbol">(</a><a id="12123" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S</a> <a id="12125" class="Symbol">_)</a>  <a id="12129" class="Symbol">=</a>  <a id="12132" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12135" class="Symbol">Œª()</a>
<a id="12139" class="Symbol">(</a><a id="12140" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="12142" class="Symbol">_)</a> <a id="12145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12048" class="Function Operator">var‚âü</a> <a id="12150" href="plfa.part2.Untyped.html#3557" class="InductiveConstructor">Z</a>  <a id="12153" class="Symbol">=</a>  <a id="12156" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12159" class="Symbol">Œª()</a>
<a id="12163" class="Symbol">(</a><a id="12164" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="12166" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12166" class="Bound">x</a><a id="12167" class="Symbol">)</a> <a id="12169" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="12174" class="Symbol">(</a><a id="12175" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S</a> <a id="12177" href="plfa.part3.Soundness.html#12177" class="Bound">y</a><a id="12178" class="Symbol">)</a> <a id="12180" class="Keyword">with</a>  <a id="12186" href="plfa.part3.Soundness.html#12166" class="Bound">x</a> <a id="12188" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="12193" href="plfa.part3.Soundness.html#12177" class="Bound">y</a>
<a id="12195" class="Symbol">...</a>                 <a id="12215" class="Symbol">|</a>  <a id="12218" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12222" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12227" class="Symbol">=</a>  <a id="12230" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12234" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12239" class="Symbol">...</a>                 <a id="12259" class="Symbol">|</a>  <a id="12262" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12265" class="Bound">neq</a>   <a id="12271" class="Symbol">=</a>  <a id="12274" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12277" class="Symbol">Œª{</a><a id="12279" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="12284" class="Symbol">‚Üí</a> <a id="12286" href="plfa.part3.Soundness.html#12265" class="Bound">neq</a> <a id="12290" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="12294" class="Symbol">}</a>

<a id="var‚âü-refl"></a><a id="12297" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12297" class="Function">var‚âü-refl</a> <a id="12307" class="Symbol">:</a> <a id="12309" class="Symbol">‚àÄ</a> <a id="12311" class="Symbol">{</a><a id="12312" href="plfa.part3.Soundness.html#12312" class="Bound">Œì</a><a id="12313" class="Symbol">}</a> <a id="12315" class="Symbol">(</a><a id="12316" href="plfa.part3.Soundness.html#12316" class="Bound">x</a> <a id="12318" class="Symbol">:</a> <a id="12320" href="plfa.part3.Soundness.html#12312" class="Bound">Œì</a> <a id="12322" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="12324" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="12325" class="Symbol">)</a> <a id="12327" class="Symbol">‚Üí</a> <a id="12329" class="Symbol">(</a><a id="12330" href="plfa.part3.Soundness.html#12316" class="Bound">x</a> <a id="12332" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="12337" href="plfa.part3.Soundness.html#12316" class="Bound">x</a><a id="12338" class="Symbol">)</a> <a id="12340" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="12342" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12346" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12351" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12297" class="Function">var‚âü-refl</a> <a id="12361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="12363" class="Symbol">=</a> <a id="12365" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="12370" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12297" class="Function">var‚âü-refl</a> <a id="12380" class="Symbol">(</a><a id="12381" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="12383" href="plfa.part3.Soundness.html#12383" class="Bound">x</a><a id="12384" class="Symbol">)</a> <a id="12386" class="Keyword">rewrite</a> <a id="12394" href="plfa.part3.Soundness.html#12297" class="Function">var‚âü-refl</a> <a id="12404" href="plfa.part3.Soundness.html#12383" class="Bound">x</a> <a id="12406" class="Symbol">=</a> <a id="12408" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>{% endraw %}
Now we use `var‚âü` to define `const-env`.

{% raw %}<pre class="Agda"><a id="const-env"></a><a id="12464" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12464" class="Function">const-env</a> <a id="12474" class="Symbol">:</a> <a id="12476" class="Symbol">‚àÄ{</a><a id="12478" href="plfa.part3.Soundness.html#12478" class="Bound">Œì</a><a id="12479" class="Symbol">}</a> <a id="12481" class="Symbol">‚Üí</a> <a id="12483" class="Symbol">(</a><a id="12484" href="plfa.part3.Soundness.html#12484" class="Bound">x</a> <a id="12486" class="Symbol">:</a> <a id="12488" href="plfa.part3.Soundness.html#12478" class="Bound">Œì</a> <a id="12490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="12492" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="12493" class="Symbol">)</a> <a id="12495" class="Symbol">‚Üí</a> <a id="12497" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4067" class="Datatype">Value</a> <a id="12503" class="Symbol">‚Üí</a> <a id="12505" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="12509" href="plfa.part3.Soundness.html#12478" class="Bound">Œì</a>
<a id="12511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12464" class="Function">const-env</a> <a id="12521" href="plfa.part3.Soundness.html#12521" class="Bound">x</a> <a id="12523" href="plfa.part3.Soundness.html#12523" class="Bound">v</a> <a id="12525" href="plfa.part3.Soundness.html#12525" class="Bound">y</a> <a id="12527" class="Keyword">with</a> <a id="12532" href="plfa.part3.Soundness.html#12521" class="Bound">x</a> <a id="12534" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="12539" href="plfa.part3.Soundness.html#12525" class="Bound">y</a>
<a id="12541" class="Symbol">...</a>             <a id="12557" class="Symbol">|</a> <a id="12559" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="12563" class="Symbol">_</a>       <a id="12571" class="Symbol">=</a> <a id="12573" class="Bound">v</a>
<a id="12575" class="Symbol">...</a>             <a id="12591" class="Symbol">|</a> <a id="12593" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="12596" class="Symbol">_</a>        <a id="12605" class="Symbol">=</a> <a id="12607" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4087" class="InductiveConstructor">‚ä•</a>
</pre>{% endraw %}
Of course, `const-env x v` maps `x` to value `v`

{% raw %}<pre class="Agda"><a id="same-const-env"></a><a id="12668" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12668" class="Function">same-const-env</a> <a id="12683" class="Symbol">:</a> <a id="12685" class="Symbol">‚àÄ{</a><a id="12687" href="plfa.part3.Soundness.html#12687" class="Bound">Œì</a><a id="12688" class="Symbol">}</a> <a id="12690" class="Symbol">{</a><a id="12691" href="plfa.part3.Soundness.html#12691" class="Bound">x</a> <a id="12693" class="Symbol">:</a> <a id="12695" href="plfa.part3.Soundness.html#12687" class="Bound">Œì</a> <a id="12697" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="12699" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="12700" class="Symbol">}</a> <a id="12702" class="Symbol">{</a><a id="12703" href="plfa.part3.Soundness.html#12703" class="Bound">v</a><a id="12704" class="Symbol">}</a> <a id="12706" class="Symbol">‚Üí</a> <a id="12708" class="Symbol">(</a><a id="12709" href="plfa.part3.Soundness.html#12464" class="Function">const-env</a> <a id="12719" href="plfa.part3.Soundness.html#12691" class="Bound">x</a> <a id="12721" href="plfa.part3.Soundness.html#12703" class="Bound">v</a><a id="12722" class="Symbol">)</a> <a id="12724" href="plfa.part3.Soundness.html#12691" class="Bound">x</a> <a id="12726" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="12728" href="plfa.part3.Soundness.html#12703" class="Bound">v</a>
<a id="12730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12668" class="Function">same-const-env</a> <a id="12745" class="Symbol">{</a><a id="12746" class="Argument">x</a> <a id="12748" class="Symbol">=</a> <a id="12750" href="plfa.part3.Soundness.html#12750" class="Bound">x</a><a id="12751" class="Symbol">}</a> <a id="12753" class="Keyword">rewrite</a> <a id="12761" href="plfa.part3.Soundness.html#12297" class="Function">var‚âü-refl</a> <a id="12771" href="plfa.part3.Soundness.html#12750" class="Bound">x</a> <a id="12773" class="Symbol">=</a> <a id="12775" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>{% endraw %}
and `const-env x v` maps `y` to `‚ä•, so long as `x ‚â¢ y`.

{% raw %}<pre class="Agda"><a id="diff-const-env"></a><a id="12846" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12846" class="Function">diff-const-env</a> <a id="12861" class="Symbol">:</a> <a id="12863" class="Symbol">‚àÄ{</a><a id="12865" href="plfa.part3.Soundness.html#12865" class="Bound">Œì</a><a id="12866" class="Symbol">}</a> <a id="12868" class="Symbol">{</a><a id="12869" href="plfa.part3.Soundness.html#12869" class="Bound">x</a> <a id="12871" href="plfa.part3.Soundness.html#12871" class="Bound">y</a> <a id="12873" class="Symbol">:</a> <a id="12875" href="plfa.part3.Soundness.html#12865" class="Bound">Œì</a> <a id="12877" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="12879" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="12880" class="Symbol">}</a> <a id="12882" class="Symbol">{</a><a id="12883" href="plfa.part3.Soundness.html#12883" class="Bound">v</a><a id="12884" class="Symbol">}</a>
  <a id="12888" class="Symbol">‚Üí</a> <a id="12890" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12869" class="Bound">x</a> <a id="12892" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#799" class="Function Operator">‚â¢</a> <a id="12894" href="plfa.part3.Soundness.html#12871" class="Bound">y</a>
    <a id="12900" class="Comment">-------------------</a>
  <a id="12922" class="Symbol">‚Üí</a> <a id="12924" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12464" class="Function">const-env</a> <a id="12934" href="plfa.part3.Soundness.html#12869" class="Bound">x</a> <a id="12936" href="plfa.part3.Soundness.html#12883" class="Bound">v</a> <a id="12938" href="plfa.part3.Soundness.html#12871" class="Bound">y</a> <a id="12940" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="12942" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4087" class="InductiveConstructor">‚ä•</a>
<a id="12944" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12846" class="Function">diff-const-env</a> <a id="12959" class="Symbol">{</a><a id="12960" href="plfa.part3.Soundness.html#12960" class="Bound">Œì</a><a id="12961" class="Symbol">}</a> <a id="12963" class="Symbol">{</a><a id="12964" href="plfa.part3.Soundness.html#12964" class="Bound">x</a><a id="12965" class="Symbol">}</a> <a id="12967" class="Symbol">{</a><a id="12968" href="plfa.part3.Soundness.html#12968" class="Bound">y</a><a id="12969" class="Symbol">}</a> <a id="12971" href="plfa.part3.Soundness.html#12971" class="Bound">neq</a> <a id="12975" class="Keyword">with</a> <a id="12980" href="plfa.part3.Soundness.html#12964" class="Bound">x</a> <a id="12982" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="12987" href="plfa.part3.Soundness.html#12968" class="Bound">y</a>
<a id="12989" class="Symbol">...</a>  <a id="12994" class="Symbol">|</a> <a id="12996" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="13000" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#13000" class="Bound">eq</a>  <a id="13004" class="Symbol">=</a>  <a id="13007" href="https://agda.github.io/agda-stdlib/v1.1/Data.Empty.html#294" class="Function">‚ä•-elim</a> <a id="13014" class="Symbol">(</a><a id="13015" class="Bound">neq</a> <a id="13019" href="plfa.part3.Soundness.html#13000" class="Bound">eq</a><a id="13021" class="Symbol">)</a>
<a id="13023" class="Symbol">...</a>  <a id="13028" class="Symbol">|</a> <a id="13030" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="13033" class="Symbol">_</a>    <a id="13038" class="Symbol">=</a>  <a id="13041" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>{% endraw %}
So we choose `const-env x v` for `Œ¥` and obtain `Œ¥ ‚ä¢ x ‚Üì v`
with the `var` rule.

It remains to prove that `Œ≥ ‚ä¢ œÉ ‚Üì Œ¥` and `Œ¥ ‚ä¢ M ‚Üì v` for any `k`, given that
we have chosen `const-env x v` for `Œ¥`.  We shall have two cases to
consider, `x ‚â° y` or `x ‚â¢ y`.

Now to finish the two cases of the proof.

* In the case where `x ‚â° y`, we need to show
  that `Œ≥ ‚ä¢ œÉ y ‚Üì v`, but that's just our premise.
* In the case where `x ‚â¢ y,` we need to show
  that `Œ≥ ‚ä¢ œÉ y ‚Üì ‚ä•`, which we do via rule `‚ä•-intro`.

Thus, we have completed the variable case of the proof that
simultaneous substitution reflects denotations.  Here is the proof
again, formally.

{% raw %}<pre class="Agda"><a id="subst-reflect-var"></a><a id="13697" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#13697" class="Function">subst-reflect-var</a> <a id="13715" class="Symbol">:</a> <a id="13717" class="Symbol">‚àÄ</a> <a id="13719" class="Symbol">{</a><a id="13720" href="plfa.part3.Soundness.html#13720" class="Bound">Œì</a> <a id="13722" href="plfa.part3.Soundness.html#13722" class="Bound">Œî</a><a id="13723" class="Symbol">}</a> <a id="13725" class="Symbol">{</a><a id="13726" href="plfa.part3.Soundness.html#13726" class="Bound">Œ≥</a> <a id="13728" class="Symbol">:</a> <a id="13730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="13734" href="plfa.part3.Soundness.html#13722" class="Bound">Œî</a><a id="13735" class="Symbol">}</a> <a id="13737" class="Symbol">{</a><a id="13738" href="plfa.part3.Soundness.html#13738" class="Bound">x</a> <a id="13740" class="Symbol">:</a> <a id="13742" href="plfa.part3.Soundness.html#13720" class="Bound">Œì</a> <a id="13744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">‚àã</a> <a id="13746" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="13747" class="Symbol">}</a> <a id="13749" class="Symbol">{</a><a id="13750" href="plfa.part3.Soundness.html#13750" class="Bound">v</a><a id="13751" class="Symbol">}</a> <a id="13753" class="Symbol">{</a><a id="13754" href="plfa.part3.Soundness.html#13754" class="Bound">œÉ</a> <a id="13756" class="Symbol">:</a> <a id="13758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="13764" href="plfa.part3.Soundness.html#13720" class="Bound">Œì</a> <a id="13766" href="plfa.part3.Soundness.html#13722" class="Bound">Œî</a><a id="13767" class="Symbol">}</a>
  <a id="13771" class="Symbol">‚Üí</a> <a id="13773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#13726" class="Bound">Œ≥</a> <a id="13775" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="13777" href="plfa.part3.Soundness.html#13754" class="Bound">œÉ</a> <a id="13779" href="plfa.part3.Soundness.html#13738" class="Bound">x</a> <a id="13781" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="13783" href="plfa.part3.Soundness.html#13750" class="Bound">v</a>
    <a id="13789" class="Comment">-----------------------------------------</a>
  <a id="13833" class="Symbol">‚Üí</a> <a id="13835" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Œ£[</a> <a id="13838" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#13838" class="Bound">Œ¥</a> <a id="13840" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">‚àà</a> <a id="13842" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="13846" href="plfa.part3.Soundness.html#13720" class="Bound">Œì</a> <a id="13848" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="13850" href="plfa.part3.Soundness.html#13726" class="Bound">Œ≥</a> <a id="13852" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="13855" href="plfa.part3.Soundness.html#13754" class="Bound">œÉ</a> <a id="13857" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="13859" href="plfa.part3.Soundness.html#13838" class="Bound">Œ¥</a>  <a id="13862" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">√ó</a>  <a id="13865" href="plfa.part3.Soundness.html#13838" class="Bound">Œ¥</a> <a id="13867" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="13869" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="13871" href="plfa.part3.Soundness.html#13738" class="Bound">x</a> <a id="13873" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="13875" href="plfa.part3.Soundness.html#13750" class="Bound">v</a>
<a id="13877" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#13697" class="Function">subst-reflect-var</a> <a id="13895" class="Symbol">{</a><a id="13896" href="plfa.part3.Soundness.html#13896" class="Bound">Œì</a><a id="13897" class="Symbol">}{</a><a id="13899" href="plfa.part3.Soundness.html#13899" class="Bound">Œî</a><a id="13900" class="Symbol">}{</a><a id="13902" href="plfa.part3.Soundness.html#13902" class="Bound">Œ≥</a><a id="13903" class="Symbol">}{</a><a id="13905" href="plfa.part3.Soundness.html#13905" class="Bound">x</a><a id="13906" class="Symbol">}{</a><a id="13908" href="plfa.part3.Soundness.html#13908" class="Bound">v</a><a id="13909" class="Symbol">}{</a><a id="13911" href="plfa.part3.Soundness.html#13911" class="Bound">œÉ</a><a id="13912" class="Symbol">}</a> <a id="13914" href="plfa.part3.Soundness.html#13914" class="Bound">xv</a>
  <a id="13919" class="Keyword">rewrite</a> <a id="13927" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="13931" class="Symbol">(</a><a id="13932" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12668" class="Function">same-const-env</a> <a id="13947" class="Symbol">{</a><a id="13948" href="plfa.part3.Soundness.html#13896" class="Bound">Œì</a><a id="13949" class="Symbol">}{</a><a id="13951" href="plfa.part3.Soundness.html#13905" class="Bound">x</a><a id="13952" class="Symbol">}{</a><a id="13954" href="plfa.part3.Soundness.html#13908" class="Bound">v</a><a id="13955" class="Symbol">})</a> <a id="13958" class="Symbol">=</a>
    <a id="13964" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="13966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#12464" class="Function">const-env</a> <a id="13976" href="plfa.part3.Soundness.html#13905" class="Bound">x</a> <a id="13978" href="plfa.part3.Soundness.html#13908" class="Bound">v</a> <a id="13980" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="13982" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="13984" href="plfa.part3.Soundness.html#14017" class="Function">const-env-ok</a> <a id="13997" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="13999" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="14003" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="14005" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
  <a id="14009" class="Keyword">where</a>
  <a id="14017" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14017" class="Function">const-env-ok</a> <a id="14030" class="Symbol">:</a> <a id="14032" href="plfa.part3.Soundness.html#13902" class="Bound">Œ≥</a> <a id="14034" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="14037" href="plfa.part3.Soundness.html#13911" class="Bound">œÉ</a> <a id="14039" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="14041" href="plfa.part3.Soundness.html#12464" class="Function">const-env</a> <a id="14051" href="plfa.part3.Soundness.html#13905" class="Bound">x</a> <a id="14053" href="plfa.part3.Soundness.html#13908" class="Bound">v</a>
  <a id="14057" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14017" class="Function">const-env-ok</a> <a id="14070" href="plfa.part3.Soundness.html#14070" class="Bound">y</a> <a id="14072" class="Keyword">with</a> <a id="14077" href="plfa.part3.Soundness.html#13905" class="Bound">x</a> <a id="14079" href="plfa.part3.Soundness.html#12048" class="Function Operator">var‚âü</a> <a id="14084" href="plfa.part3.Soundness.html#14070" class="Bound">y</a>
  <a id="14088" class="Symbol">...</a> <a id="14092" class="Symbol">|</a> <a id="14094" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#641" class="InductiveConstructor">yes</a> <a id="14098" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14098" class="Bound">x‚â°y</a> <a id="14102" class="Keyword">rewrite</a> <a id="14110" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="14114" href="plfa.part3.Soundness.html#14098" class="Bound">x‚â°y</a> <a id="14118" class="Symbol">|</a> <a id="14120" href="plfa.part3.Soundness.html#12668" class="Function">same-const-env</a> <a id="14135" class="Symbol">{</a><a id="14136" href="plfa.part3.Soundness.html#13896" class="Bound">Œì</a><a id="14137" class="Symbol">}{</a><a id="14139" href="plfa.part3.Soundness.html#13905" class="Bound">x</a><a id="14140" class="Symbol">}{</a><a id="14142" href="plfa.part3.Soundness.html#13908" class="Bound">v</a><a id="14143" class="Symbol">}</a> <a id="14145" class="Symbol">=</a> <a id="14147" href="plfa.part3.Soundness.html#13914" class="Bound">xv</a>
  <a id="14152" class="Symbol">...</a> <a id="14156" class="Symbol">|</a> <a id="14158" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Nullary.html#668" class="InductiveConstructor">no</a> <a id="14161" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14161" class="Bound">x‚â¢y</a> <a id="14165" class="Keyword">rewrite</a> <a id="14173" href="plfa.part3.Soundness.html#12846" class="Function">diff-const-env</a> <a id="14188" class="Symbol">{</a><a id="14189" href="plfa.part3.Soundness.html#13896" class="Bound">Œì</a><a id="14190" class="Symbol">}{</a><a id="14192" href="plfa.part3.Soundness.html#13905" class="Bound">x</a><a id="14193" class="Symbol">}{</a><a id="14195" class="Bound">y</a><a id="14196" class="Symbol">}{</a><a id="14198" href="plfa.part3.Soundness.html#13908" class="Bound">v</a><a id="14199" class="Symbol">}</a> <a id="14201" href="plfa.part3.Soundness.html#14161" class="Bound">x‚â¢y</a> <a id="14205" class="Symbol">=</a> <a id="14207" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a>
</pre>{% endraw %}

### Substitutions and environment construction

Every substitution produces terms that can evaluate to `‚ä•`.

{% raw %}<pre class="Agda"><a id="subst-‚ä•"></a><a id="14334" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14334" class="Function">subst-‚ä•</a> <a id="14342" class="Symbol">:</a> <a id="14344" class="Symbol">‚àÄ{</a><a id="14346" href="plfa.part3.Soundness.html#14346" class="Bound">Œì</a> <a id="14348" href="plfa.part3.Soundness.html#14348" class="Bound">Œî</a><a id="14349" class="Symbol">}{</a><a id="14351" href="plfa.part3.Soundness.html#14351" class="Bound">Œ≥</a> <a id="14353" class="Symbol">:</a> <a id="14355" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="14359" href="plfa.part3.Soundness.html#14348" class="Bound">Œî</a><a id="14360" class="Symbol">}{</a><a id="14362" href="plfa.part3.Soundness.html#14362" class="Bound">œÉ</a> <a id="14364" class="Symbol">:</a> <a id="14366" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="14372" href="plfa.part3.Soundness.html#14346" class="Bound">Œì</a> <a id="14374" href="plfa.part3.Soundness.html#14348" class="Bound">Œî</a><a id="14375" class="Symbol">}</a>
    <a id="14381" class="Comment">-----------------</a>
  <a id="14401" class="Symbol">‚Üí</a> <a id="14403" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14351" class="Bound">Œ≥</a> <a id="14405" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="14408" href="plfa.part3.Soundness.html#14362" class="Bound">œÉ</a> <a id="14410" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="14412" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8227" class="Function">`‚ä•</a>
<a id="14415" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14334" class="Function">subst-‚ä•</a> <a id="14423" href="plfa.part3.Soundness.html#14423" class="Bound">x</a> <a id="14425" class="Symbol">=</a> <a id="14427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a>
</pre>{% endraw %}
If a substitution produces terms that evaluate to the values in
both `Œ≥‚ÇÅ` and `Œ≥‚ÇÇ`, then those terms also evaluate to the values in
`Œ≥‚ÇÅ ‚äî Œ≥‚ÇÇ`.

{% raw %}<pre class="Agda"><a id="subst-‚äî"></a><a id="14588" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14588" class="Function">subst-‚äî</a> <a id="14596" class="Symbol">:</a> <a id="14598" class="Symbol">‚àÄ{</a><a id="14600" href="plfa.part3.Soundness.html#14600" class="Bound">Œì</a> <a id="14602" href="plfa.part3.Soundness.html#14602" class="Bound">Œî</a><a id="14603" class="Symbol">}{</a><a id="14605" href="plfa.part3.Soundness.html#14605" class="Bound">Œ≥</a> <a id="14607" class="Symbol">:</a> <a id="14609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="14613" href="plfa.part3.Soundness.html#14602" class="Bound">Œî</a><a id="14614" class="Symbol">}{</a><a id="14616" href="plfa.part3.Soundness.html#14616" class="Bound">Œ≥‚ÇÅ</a> <a id="14619" href="plfa.part3.Soundness.html#14619" class="Bound">Œ≥‚ÇÇ</a> <a id="14622" class="Symbol">:</a> <a id="14624" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="14628" href="plfa.part3.Soundness.html#14600" class="Bound">Œì</a><a id="14629" class="Symbol">}{</a><a id="14631" href="plfa.part3.Soundness.html#14631" class="Bound">œÉ</a> <a id="14633" class="Symbol">:</a> <a id="14635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="14641" href="plfa.part3.Soundness.html#14600" class="Bound">Œì</a> <a id="14643" href="plfa.part3.Soundness.html#14602" class="Bound">Œî</a><a id="14644" class="Symbol">}</a>
           <a id="14657" class="Symbol">‚Üí</a> <a id="14659" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14605" class="Bound">Œ≥</a> <a id="14661" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="14664" href="plfa.part3.Soundness.html#14631" class="Bound">œÉ</a> <a id="14666" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="14668" href="plfa.part3.Soundness.html#14616" class="Bound">Œ≥‚ÇÅ</a>
           <a id="14682" class="Symbol">‚Üí</a> <a id="14684" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14605" class="Bound">Œ≥</a> <a id="14686" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="14689" href="plfa.part3.Soundness.html#14631" class="Bound">œÉ</a> <a id="14691" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="14693" href="plfa.part3.Soundness.html#14619" class="Bound">Œ≥‚ÇÇ</a>
             <a id="14709" class="Comment">-------------------------</a>
           <a id="14746" class="Symbol">‚Üí</a> <a id="14748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14605" class="Bound">Œ≥</a> <a id="14750" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="14753" href="plfa.part3.Soundness.html#14631" class="Bound">œÉ</a> <a id="14755" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="14757" class="Symbol">(</a><a id="14758" href="plfa.part3.Soundness.html#14616" class="Bound">Œ≥‚ÇÅ</a> <a id="14761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8256" class="Function Operator">`‚äî</a> <a id="14764" href="plfa.part3.Soundness.html#14619" class="Bound">Œ≥‚ÇÇ</a><a id="14766" class="Symbol">)</a>
<a id="14768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14588" class="Function">subst-‚äî</a> <a id="14776" href="plfa.part3.Soundness.html#14776" class="Bound">Œ≥‚ÇÅ-ok</a> <a id="14782" href="plfa.part3.Soundness.html#14782" class="Bound">Œ≥‚ÇÇ-ok</a> <a id="14788" href="plfa.part3.Soundness.html#14788" class="Bound">x</a> <a id="14790" class="Symbol">=</a> <a id="14792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="14800" class="Symbol">(</a><a id="14801" href="plfa.part3.Soundness.html#14776" class="Bound">Œ≥‚ÇÅ-ok</a> <a id="14807" href="plfa.part3.Soundness.html#14788" class="Bound">x</a><a id="14808" class="Symbol">)</a> <a id="14810" class="Symbol">(</a><a id="14811" href="plfa.part3.Soundness.html#14782" class="Bound">Œ≥‚ÇÇ-ok</a> <a id="14817" href="plfa.part3.Soundness.html#14788" class="Bound">x</a><a id="14818" class="Symbol">)</a>
</pre>{% endraw %}
### The Lambda constructor is injective

{% raw %}<pre class="Agda"><a id="lambda-inj"></a><a id="14870" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14870" class="Function">lambda-inj</a> <a id="14881" class="Symbol">:</a> <a id="14883" class="Symbol">‚àÄ</a> <a id="14885" class="Symbol">{</a><a id="14886" href="plfa.part3.Soundness.html#14886" class="Bound">Œì</a><a id="14887" class="Symbol">}</a> <a id="14889" class="Symbol">{</a><a id="14890" href="plfa.part3.Soundness.html#14890" class="Bound">M</a> <a id="14892" href="plfa.part3.Soundness.html#14892" class="Bound">N</a> <a id="14894" class="Symbol">:</a> <a id="14896" href="plfa.part3.Soundness.html#14886" class="Bound">Œì</a> <a id="14898" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="14900" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a> <a id="14902" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="14904" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a> <a id="14906" class="Symbol">}</a>
  <a id="14910" class="Symbol">‚Üí</a> <a id="14912" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_‚â°_</a> <a id="14916" class="Symbol">{</a><a id="14917" class="Argument">A</a> <a id="14919" class="Symbol">=</a> <a id="14921" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14886" class="Bound">Œì</a> <a id="14923" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="14925" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="14926" class="Symbol">}</a> <a id="14928" class="Symbol">(</a><a id="14929" href="plfa.part2.Untyped.html#4382" class="InductiveConstructor Operator">∆õ</a> <a id="14931" href="plfa.part3.Soundness.html#14890" class="Bound">M</a><a id="14932" class="Symbol">)</a> <a id="14934" class="Symbol">(</a><a id="14935" href="plfa.part2.Untyped.html#4382" class="InductiveConstructor Operator">∆õ</a> <a id="14937" href="plfa.part3.Soundness.html#14892" class="Bound">N</a><a id="14938" class="Symbol">)</a>
    <a id="14944" class="Comment">---------------------------</a>
  <a id="14974" class="Symbol">‚Üí</a> <a id="14976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14890" class="Bound">M</a> <a id="14978" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="14980" href="plfa.part3.Soundness.html#14892" class="Bound">N</a>
<a id="14982" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14870" class="Function">lambda-inj</a> <a id="14993" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="14998" class="Symbol">=</a> <a id="15000" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre>{% endraw %}
### Simultaneous substitution reflects denotations

In this section we prove a central lemma, that
substitution reflects denotations. That is, if `Œ≥ ‚ä¢ subst œÉ M ‚Üì v`, then
`Œ¥ ‚ä¢ M ‚Üì v` and `Œ≥ ‚ä¢ œÉ ‚Üì Œ¥` for some `Œ¥`. We shall proceed by induction on
the derivation of `Œ≥ ‚ä¢ subst œÉ M ‚Üì v`. This requires a minor
restatement of the lemma, changing the premise to `Œ≥ ‚ä¢ L ‚Üì v` and
`L ‚â° subst œÉ M`.

{% raw %}<pre class="Agda"><a id="split"></a><a id="15406" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15406" class="Function">split</a> <a id="15412" class="Symbol">:</a> <a id="15414" class="Symbol">‚àÄ</a> <a id="15416" class="Symbol">{</a><a id="15417" href="plfa.part3.Soundness.html#15417" class="Bound">Œì</a><a id="15418" class="Symbol">}</a> <a id="15420" class="Symbol">{</a><a id="15421" href="plfa.part3.Soundness.html#15421" class="Bound">M</a> <a id="15423" class="Symbol">:</a> <a id="15425" href="plfa.part3.Soundness.html#15417" class="Bound">Œì</a> <a id="15427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="15429" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a> <a id="15431" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="15433" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="15434" class="Symbol">}</a> <a id="15436" class="Symbol">{</a><a id="15437" href="plfa.part3.Soundness.html#15437" class="Bound">Œ¥</a> <a id="15439" class="Symbol">:</a> <a id="15441" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="15445" class="Symbol">(</a><a id="15446" href="plfa.part3.Soundness.html#15417" class="Bound">Œì</a> <a id="15448" href="plfa.part2.Untyped.html#3191" class="InductiveConstructor Operator">,</a> <a id="15450" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="15451" class="Symbol">)}</a> <a id="15454" class="Symbol">{</a><a id="15455" href="plfa.part3.Soundness.html#15455" class="Bound">v</a><a id="15456" class="Symbol">}</a>
  <a id="15460" class="Symbol">‚Üí</a> <a id="15462" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15437" class="Bound">Œ¥</a> <a id="15464" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="15466" href="plfa.part3.Soundness.html#15421" class="Bound">M</a> <a id="15468" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="15470" href="plfa.part3.Soundness.html#15455" class="Bound">v</a>
    <a id="15476" class="Comment">--------------------------</a>
  <a id="15505" class="Symbol">‚Üí</a> <a id="15507" class="Symbol">(</a><a id="15508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7602" class="Function">init</a> <a id="15513" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15437" class="Bound">Œ¥</a> <a id="15515" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="15518" href="plfa.part3.Denotational.html#7657" class="Function">last</a> <a id="15523" href="plfa.part3.Soundness.html#15437" class="Bound">Œ¥</a><a id="15524" class="Symbol">)</a> <a id="15526" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="15528" href="plfa.part3.Soundness.html#15421" class="Bound">M</a> <a id="15530" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="15532" href="plfa.part3.Soundness.html#15455" class="Bound">v</a>
<a id="15534" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15406" class="Function">split</a> <a id="15540" class="Symbol">{</a><a id="15541" class="Argument">Œ¥</a> <a id="15543" class="Symbol">=</a> <a id="15545" href="plfa.part3.Soundness.html#15545" class="Bound">Œ¥</a><a id="15546" class="Symbol">}</a> <a id="15548" href="plfa.part3.Soundness.html#15548" class="Bound">Œ¥Mv</a> <a id="15552" class="Keyword">rewrite</a> <a id="15560" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7706" class="Function">init-last</a> <a id="15570" href="plfa.part3.Soundness.html#15545" class="Bound">Œ¥</a> <a id="15572" class="Symbol">=</a> <a id="15574" href="plfa.part3.Soundness.html#15548" class="Bound">Œ¥Mv</a>

<a id="subst-reflect"></a><a id="15579" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="15593" class="Symbol">:</a> <a id="15595" class="Symbol">‚àÄ</a> <a id="15597" class="Symbol">{</a><a id="15598" href="plfa.part3.Soundness.html#15598" class="Bound">Œì</a> <a id="15600" href="plfa.part3.Soundness.html#15600" class="Bound">Œî</a><a id="15601" class="Symbol">}</a> <a id="15603" class="Symbol">{</a><a id="15604" href="plfa.part3.Soundness.html#15604" class="Bound">Œ¥</a> <a id="15606" class="Symbol">:</a> <a id="15608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="15612" href="plfa.part3.Soundness.html#15600" class="Bound">Œî</a><a id="15613" class="Symbol">}</a> <a id="15615" class="Symbol">{</a><a id="15616" href="plfa.part3.Soundness.html#15616" class="Bound">M</a> <a id="15618" class="Symbol">:</a> <a id="15620" href="plfa.part3.Soundness.html#15598" class="Bound">Œì</a> <a id="15622" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="15624" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="15625" class="Symbol">}</a> <a id="15627" class="Symbol">{</a><a id="15628" href="plfa.part3.Soundness.html#15628" class="Bound">v</a><a id="15629" class="Symbol">}</a> <a id="15631" class="Symbol">{</a><a id="15632" href="plfa.part3.Soundness.html#15632" class="Bound">L</a> <a id="15634" class="Symbol">:</a> <a id="15636" href="plfa.part3.Soundness.html#15600" class="Bound">Œî</a> <a id="15638" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="15640" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="15641" class="Symbol">}</a> <a id="15643" class="Symbol">{</a><a id="15644" href="plfa.part3.Soundness.html#15644" class="Bound">œÉ</a> <a id="15646" class="Symbol">:</a> <a id="15648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="15654" href="plfa.part3.Soundness.html#15598" class="Bound">Œì</a> <a id="15656" href="plfa.part3.Soundness.html#15600" class="Bound">Œî</a><a id="15657" class="Symbol">}</a>
  <a id="15661" class="Symbol">‚Üí</a> <a id="15663" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15604" class="Bound">Œ¥</a> <a id="15665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="15667" href="plfa.part3.Soundness.html#15632" class="Bound">L</a> <a id="15669" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="15671" href="plfa.part3.Soundness.html#15628" class="Bound">v</a>
  <a id="15675" class="Symbol">‚Üí</a> <a id="15677" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="15683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15644" class="Bound">œÉ</a> <a id="15685" href="plfa.part3.Soundness.html#15616" class="Bound">M</a> <a id="15687" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="15689" href="plfa.part3.Soundness.html#15632" class="Bound">L</a>
    <a id="15695" class="Comment">---------------------------------------</a>
  <a id="15737" class="Symbol">‚Üí</a> <a id="15739" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Œ£[</a> <a id="15742" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15742" class="Bound">Œ≥</a> <a id="15744" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">‚àà</a> <a id="15746" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="15750" href="plfa.part3.Soundness.html#15598" class="Bound">Œì</a> <a id="15752" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="15754" href="plfa.part3.Soundness.html#15604" class="Bound">Œ¥</a> <a id="15756" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="15759" href="plfa.part3.Soundness.html#15644" class="Bound">œÉ</a> <a id="15761" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="15763" href="plfa.part3.Soundness.html#15742" class="Bound">Œ≥</a>  <a id="15766" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">√ó</a>  <a id="15769" href="plfa.part3.Soundness.html#15742" class="Bound">Œ≥</a> <a id="15771" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="15773" href="plfa.part3.Soundness.html#15616" class="Bound">M</a> <a id="15775" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="15777" href="plfa.part3.Soundness.html#15628" class="Bound">v</a>

<a id="15780" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="15794" class="Symbol">{</a><a id="15795" class="Argument">M</a> <a id="15797" class="Symbol">=</a> <a id="15799" href="plfa.part3.Soundness.html#15799" class="Bound">M</a><a id="15800" class="Symbol">}{</a><a id="15802" class="Argument">œÉ</a> <a id="15804" class="Symbol">=</a> <a id="15806" href="plfa.part3.Soundness.html#15806" class="Bound">œÉ</a><a id="15807" class="Symbol">}</a> <a id="15809" class="Symbol">(</a><a id="15810" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="15814" class="Symbol">{</a><a id="15815" class="Argument">x</a> <a id="15817" class="Symbol">=</a> <a id="15819" href="plfa.part3.Soundness.html#15819" class="Bound">y</a><a id="15820" class="Symbol">})</a> <a id="15823" href="plfa.part3.Soundness.html#15823" class="Bound">eqL</a> <a id="15827" class="Keyword">with</a> <a id="15832" href="plfa.part3.Soundness.html#15799" class="Bound">M</a>
<a id="15834" class="Symbol">...</a> <a id="15838" class="Symbol">|</a> <a id="15840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="15842" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15842" class="Bound">x</a>  <a id="15845" class="Keyword">with</a> <a id="15850" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="15854" class="Symbol">{</a><a id="15855" class="Argument">x</a> <a id="15857" class="Symbol">=</a> <a id="15859" class="Bound">y</a><a id="15860" class="Symbol">}</a>
<a id="15862" class="Symbol">...</a>           <a id="15876" class="Symbol">|</a> <a id="15878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15878" class="Bound">yv</a>  <a id="15882" class="Keyword">rewrite</a> <a id="15890" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="15894" class="Bound">eqL</a> <a id="15898" class="Symbol">=</a> <a id="15900" href="plfa.part3.Soundness.html#13697" class="Function">subst-reflect-var</a> <a id="15918" class="Symbol">{</a><a id="15919" class="Argument">œÉ</a> <a id="15921" class="Symbol">=</a> <a id="15923" class="Bound">œÉ</a><a id="15924" class="Symbol">}</a> <a id="15926" href="plfa.part3.Soundness.html#15878" class="Bound">yv</a>
<a id="15929" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="15943" class="Symbol">{</a><a id="15944" class="Argument">M</a> <a id="15946" class="Symbol">=</a> <a id="15948" href="plfa.part3.Soundness.html#15948" class="Bound">M</a><a id="15949" class="Symbol">}</a> <a id="15951" class="Symbol">(</a><a id="15952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="15956" class="Symbol">{</a><a id="15957" class="Argument">x</a> <a id="15959" class="Symbol">=</a> <a id="15961" href="plfa.part3.Soundness.html#15961" class="Bound">y</a><a id="15962" class="Symbol">})</a> <a id="15965" class="Symbol">()</a> <a id="15968" class="Symbol">|</a> <a id="15970" href="plfa.part3.Soundness.html#15970" class="Bound">M‚ÇÅ</a> <a id="15973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="15975" href="plfa.part3.Soundness.html#15975" class="Bound">M‚ÇÇ</a>
<a id="15978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="15992" class="Symbol">{</a><a id="15993" class="Argument">M</a> <a id="15995" class="Symbol">=</a> <a id="15997" href="plfa.part3.Soundness.html#15997" class="Bound">M</a><a id="15998" class="Symbol">}</a> <a id="16000" class="Symbol">(</a><a id="16001" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="16005" class="Symbol">{</a><a id="16006" class="Argument">x</a> <a id="16008" class="Symbol">=</a> <a id="16010" href="plfa.part3.Soundness.html#16010" class="Bound">y</a><a id="16011" class="Symbol">})</a> <a id="16014" class="Symbol">()</a> <a id="16017" class="Symbol">|</a> <a id="16019" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="16021" href="plfa.part3.Soundness.html#16021" class="Bound">M‚Ä≤</a>

<a id="16025" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16039" class="Symbol">{</a><a id="16040" class="Argument">M</a> <a id="16042" class="Symbol">=</a> <a id="16044" href="plfa.part3.Soundness.html#16044" class="Bound">M</a><a id="16045" class="Symbol">}{</a><a id="16047" class="Argument">œÉ</a> <a id="16049" class="Symbol">=</a> <a id="16051" href="plfa.part3.Soundness.html#16051" class="Bound">œÉ</a><a id="16052" class="Symbol">}</a> <a id="16054" class="Symbol">(</a><a id="16055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="16062" href="plfa.part3.Soundness.html#16062" class="Bound">d‚ÇÅ</a> <a id="16065" href="plfa.part3.Soundness.html#16065" class="Bound">d‚ÇÇ</a><a id="16067" class="Symbol">)</a> <a id="16069" href="plfa.part3.Soundness.html#16069" class="Bound">eqL</a>
         <a id="16082" class="Keyword">with</a> <a id="16087" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16044" class="Bound">M</a>
<a id="16089" class="Symbol">...</a>    <a id="16096" class="Symbol">|</a> <a id="16098" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="16100" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16100" class="Bound">x</a> <a id="16102" class="Keyword">with</a> <a id="16107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="16114" class="Bound">d‚ÇÅ</a> <a id="16117" class="Bound">d‚ÇÇ</a>
<a id="16120" class="Symbol">...</a>    <a id="16127" class="Symbol">|</a> <a id="16129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16129" class="Bound">d‚Ä≤</a> <a id="16132" class="Keyword">rewrite</a> <a id="16140" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="16144" class="Bound">eqL</a> <a id="16148" class="Symbol">=</a> <a id="16150" href="plfa.part3.Soundness.html#13697" class="Function">subst-reflect-var</a> <a id="16168" class="Symbol">{</a><a id="16169" class="Argument">œÉ</a> <a id="16171" class="Symbol">=</a> <a id="16173" class="Bound">œÉ</a><a id="16174" class="Symbol">}</a> <a id="16176" href="plfa.part3.Soundness.html#16129" class="Bound">d‚Ä≤</a>
<a id="16179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16193" class="Symbol">(</a><a id="16194" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="16201" href="plfa.part3.Soundness.html#16201" class="Bound">d‚ÇÅ</a> <a id="16204" href="plfa.part3.Soundness.html#16204" class="Bound">d‚ÇÇ</a><a id="16206" class="Symbol">)</a> <a id="16208" class="Symbol">()</a> <a id="16211" class="Symbol">|</a> <a id="16213" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="16215" href="plfa.part3.Soundness.html#16215" class="Bound">M‚Ä≤</a>
<a id="16218" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a><a id="16231" class="Symbol">{</a><a id="16232" href="plfa.part3.Soundness.html#16232" class="Bound">Œì</a><a id="16233" class="Symbol">}{</a><a id="16235" href="plfa.part3.Soundness.html#16235" class="Bound">Œî</a><a id="16236" class="Symbol">}{</a><a id="16238" href="plfa.part3.Soundness.html#16238" class="Bound">Œ≥</a><a id="16239" class="Symbol">}{</a><a id="16241" class="Argument">œÉ</a> <a id="16243" class="Symbol">=</a> <a id="16245" href="plfa.part3.Soundness.html#16245" class="Bound">œÉ</a><a id="16246" class="Symbol">}</a> <a id="16248" class="Symbol">(</a><a id="16249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="16256" href="plfa.part3.Soundness.html#16256" class="Bound">d‚ÇÅ</a> <a id="16259" href="plfa.part3.Soundness.html#16259" class="Bound">d‚ÇÇ</a><a id="16261" class="Symbol">)</a>
   <a id="16266" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="16271" class="Symbol">|</a> <a id="16273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16273" class="Bound">M‚ÇÅ</a> <a id="16276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="16278" href="plfa.part3.Soundness.html#16278" class="Bound">M‚ÇÇ</a>
     <a id="16286" class="Keyword">with</a> <a id="16291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16305" class="Symbol">{</a><a id="16306" class="Argument">M</a> <a id="16308" class="Symbol">=</a> <a id="16310" href="plfa.part3.Soundness.html#16273" class="Bound">M‚ÇÅ</a><a id="16312" class="Symbol">}</a> <a id="16314" href="plfa.part3.Soundness.html#16256" class="Bound">d‚ÇÅ</a> <a id="16317" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="16322" class="Symbol">|</a> <a id="16324" href="plfa.part3.Soundness.html#15579" class="Function">subst-reflect</a> <a id="16338" class="Symbol">{</a><a id="16339" class="Argument">M</a> <a id="16341" class="Symbol">=</a> <a id="16343" href="plfa.part3.Soundness.html#16278" class="Bound">M‚ÇÇ</a><a id="16345" class="Symbol">}</a> <a id="16347" href="plfa.part3.Soundness.html#16259" class="Bound">d‚ÇÇ</a> <a id="16350" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="16355" class="Symbol">...</a>     <a id="16363" class="Symbol">|</a> <a id="16365" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16367" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16367" class="Bound">Œ¥‚ÇÅ</a> <a id="16370" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16372" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16374" href="plfa.part3.Soundness.html#16374" class="Bound">subst-Œ¥‚ÇÅ</a> <a id="16383" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16385" href="plfa.part3.Soundness.html#16385" class="Bound">m1</a> <a id="16388" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16390" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16392" class="Symbol">|</a> <a id="16394" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16396" href="plfa.part3.Soundness.html#16396" class="Bound">Œ¥‚ÇÇ</a> <a id="16399" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16401" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16403" href="plfa.part3.Soundness.html#16403" class="Bound">subst-Œ¥‚ÇÇ</a> <a id="16412" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16414" href="plfa.part3.Soundness.html#16414" class="Bound">m2</a> <a id="16417" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16419" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16421" class="Symbol">=</a>
     <a id="16428" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16367" class="Bound">Œ¥‚ÇÅ</a> <a id="16433" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8256" class="Function Operator">`‚äî</a> <a id="16436" href="plfa.part3.Soundness.html#16396" class="Bound">Œ¥‚ÇÇ</a> <a id="16439" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16441" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16443" href="plfa.part3.Soundness.html#14588" class="Function">subst-‚äî</a> <a id="16451" class="Symbol">{</a><a id="16452" class="Argument">Œ≥‚ÇÅ</a> <a id="16455" class="Symbol">=</a> <a id="16457" href="plfa.part3.Soundness.html#16367" class="Bound">Œ¥‚ÇÅ</a><a id="16459" class="Symbol">}{</a><a id="16461" class="Argument">Œ≥‚ÇÇ</a> <a id="16464" class="Symbol">=</a> <a id="16466" href="plfa.part3.Soundness.html#16396" class="Bound">Œ¥‚ÇÇ</a><a id="16468" class="Symbol">}{</a><a id="16470" class="Argument">œÉ</a> <a id="16472" class="Symbol">=</a> <a id="16474" class="Bound">œÉ</a><a id="16475" class="Symbol">}</a> <a id="16477" href="plfa.part3.Soundness.html#16374" class="Bound">subst-Œ¥‚ÇÅ</a> <a id="16486" href="plfa.part3.Soundness.html#16403" class="Bound">subst-Œ¥‚ÇÇ</a> <a id="16495" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
                    <a id="16517" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="16524" class="Symbol">(</a><a id="16525" href="plfa.part3.Denotational.html#25631" class="Function">‚äë-env</a> <a id="16531" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16385" class="Bound">m1</a> <a id="16534" class="Symbol">(</a><a id="16535" href="plfa.part3.Denotational.html#8586" class="Function">‚äë-env-conj-R1</a> <a id="16549" href="plfa.part3.Soundness.html#16367" class="Bound">Œ¥‚ÇÅ</a> <a id="16552" href="plfa.part3.Soundness.html#16396" class="Bound">Œ¥‚ÇÇ</a><a id="16554" class="Symbol">))</a>
                           <a id="16584" class="Symbol">(</a><a id="16585" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#25631" class="Function">‚äë-env</a> <a id="16591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16414" class="Bound">m2</a> <a id="16594" class="Symbol">(</a><a id="16595" href="plfa.part3.Denotational.html#8692" class="Function">‚äë-env-conj-R2</a> <a id="16609" href="plfa.part3.Soundness.html#16367" class="Bound">Œ¥‚ÇÅ</a> <a id="16612" href="plfa.part3.Soundness.html#16396" class="Bound">Œ¥‚ÇÇ</a><a id="16614" class="Symbol">))</a> <a id="16617" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16619" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>

<a id="16622" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16636" class="Symbol">{</a><a id="16637" class="Argument">M</a> <a id="16639" class="Symbol">=</a> <a id="16641" href="plfa.part3.Soundness.html#16641" class="Bound">M</a><a id="16642" class="Symbol">}{</a><a id="16644" class="Argument">œÉ</a> <a id="16646" class="Symbol">=</a> <a id="16648" href="plfa.part3.Soundness.html#16648" class="Bound">œÉ</a><a id="16649" class="Symbol">}</a> <a id="16651" class="Symbol">(</a><a id="16652" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="16660" href="plfa.part3.Soundness.html#16660" class="Bound">d</a><a id="16661" class="Symbol">)</a> <a id="16663" href="plfa.part3.Soundness.html#16663" class="Bound">eqL</a> <a id="16667" class="Keyword">with</a> <a id="16672" href="plfa.part3.Soundness.html#16641" class="Bound">M</a>
<a id="16674" class="Symbol">...</a>    <a id="16681" class="Symbol">|</a> <a id="16683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="16685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16685" class="Bound">x</a> <a id="16687" class="Keyword">with</a> <a id="16692" class="Symbol">(</a><a id="16693" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="16701" class="Bound">d</a><a id="16702" class="Symbol">)</a>
<a id="16704" class="Symbol">...</a>             <a id="16720" class="Symbol">|</a> <a id="16722" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16722" class="Bound">d‚Ä≤</a> <a id="16725" class="Keyword">rewrite</a> <a id="16733" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="16737" class="Bound">eqL</a> <a id="16741" class="Symbol">=</a> <a id="16743" href="plfa.part3.Soundness.html#13697" class="Function">subst-reflect-var</a> <a id="16761" class="Symbol">{</a><a id="16762" class="Argument">œÉ</a> <a id="16764" class="Symbol">=</a> <a id="16766" class="Bound">œÉ</a><a id="16767" class="Symbol">}</a> <a id="16769" href="plfa.part3.Soundness.html#16722" class="Bound">d‚Ä≤</a>
<a id="16772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16786" class="Symbol">{</a><a id="16787" class="Argument">œÉ</a> <a id="16789" class="Symbol">=</a> <a id="16791" href="plfa.part3.Soundness.html#16791" class="Bound">œÉ</a><a id="16792" class="Symbol">}</a> <a id="16794" class="Symbol">(</a><a id="16795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="16803" href="plfa.part3.Soundness.html#16803" class="Bound">d</a><a id="16804" class="Symbol">)</a> <a id="16806" href="plfa.part3.Soundness.html#16806" class="Bound">eq</a> <a id="16809" class="Symbol">|</a> <a id="16811" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="16813" href="plfa.part3.Soundness.html#16813" class="Bound">M‚Ä≤</a>
      <a id="16822" class="Keyword">with</a> <a id="16827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="16841" class="Symbol">{</a><a id="16842" class="Argument">œÉ</a> <a id="16844" class="Symbol">=</a> <a id="16846" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="16851" href="plfa.part3.Soundness.html#16791" class="Bound">œÉ</a><a id="16852" class="Symbol">}</a> <a id="16854" href="plfa.part3.Soundness.html#16803" class="Bound">d</a> <a id="16856" class="Symbol">(</a><a id="16857" href="plfa.part3.Soundness.html#14870" class="Function">lambda-inj</a> <a id="16868" href="plfa.part3.Soundness.html#16806" class="Bound">eq</a><a id="16870" class="Symbol">)</a>
<a id="16872" class="Symbol">...</a> <a id="16876" class="Symbol">|</a> <a id="16878" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16880" class="Bound">Œ¥‚Ä≤</a> <a id="16883" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16887" href="plfa.part3.Soundness.html#16887" class="Bound">exts-œÉ-Œ¥‚Ä≤</a> <a id="16897" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16899" href="plfa.part3.Soundness.html#16899" class="Bound">m‚Ä≤</a> <a id="16902" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16904" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="16906" class="Symbol">=</a>
    <a id="16912" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16914" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7602" class="Function">init</a> <a id="16919" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#16880" class="Bound">Œ¥‚Ä≤</a> <a id="16922" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="16924" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="16926" class="Symbol">((Œª</a> <a id="16930" href="plfa.part3.Soundness.html#16930" class="Bound">x</a> <a id="16932" class="Symbol">‚Üí</a> <a id="16934" href="plfa.part3.Soundness.html#11148" class="Function">rename-inc-reflect</a> <a id="16953" class="Symbol">(</a><a id="16954" href="plfa.part3.Soundness.html#16887" class="Bound">exts-œÉ-Œ¥‚Ä≤</a> <a id="16964" class="Symbol">(</a><a id="16965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="16967" href="plfa.part3.Soundness.html#16930" class="Bound">x</a><a id="16968" class="Symbol">))))</a> <a id="16973" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
             <a id="16988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="16996" class="Symbol">(</a><a id="16997" href="plfa.part3.Denotational.html#26062" class="Function">up-env</a> <a id="17004" class="Symbol">(</a><a id="17005" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15406" class="Function">split</a> <a id="17011" href="plfa.part3.Soundness.html#16899" class="Bound">m‚Ä≤</a><a id="17013" class="Symbol">)</a> <a id="17015" class="Symbol">(</a><a id="17016" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Compositional.md %}{% raw %}#10031" class="Function">var-inv</a> <a id="17024" class="Symbol">(</a><a id="17025" href="plfa.part3.Soundness.html#16887" class="Bound">exts-œÉ-Œ¥‚Ä≤</a> <a id="17035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a><a id="17036" class="Symbol">)))</a> <a id="17040" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17042" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
<a id="17044" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17058" class="Symbol">(</a><a id="17059" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="17067" href="plfa.part3.Soundness.html#17067" class="Bound">d</a><a id="17068" class="Symbol">)</a> <a id="17070" class="Symbol">()</a> <a id="17073" class="Symbol">|</a> <a id="17075" href="plfa.part3.Soundness.html#17075" class="Bound">M‚ÇÅ</a> <a id="17078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">¬∑</a> <a id="17080" href="plfa.part3.Soundness.html#17080" class="Bound">M‚ÇÇ</a>

<a id="17084" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17098" class="Symbol">{</a><a id="17099" class="Argument">œÉ</a> <a id="17101" class="Symbol">=</a> <a id="17103" href="plfa.part3.Soundness.html#17103" class="Bound">œÉ</a><a id="17104" class="Symbol">}</a> <a id="17106" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="17114" href="plfa.part3.Soundness.html#17114" class="Bound">eq</a> <a id="17117" class="Symbol">=</a>
    <a id="17123" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17125" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8227" class="Function">`‚ä•</a> <a id="17128" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17130" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#14334" class="Function">subst-‚ä•</a> <a id="17140" class="Symbol">{</a><a id="17141" class="Argument">œÉ</a> <a id="17143" class="Symbol">=</a> <a id="17145" href="plfa.part3.Soundness.html#17103" class="Bound">œÉ</a><a id="17146" class="Symbol">}</a> <a id="17148" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17150" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="17158" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17160" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>

<a id="17163" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17177" class="Symbol">{</a><a id="17178" class="Argument">œÉ</a> <a id="17180" class="Symbol">=</a> <a id="17182" href="plfa.part3.Soundness.html#17182" class="Bound">œÉ</a><a id="17183" class="Symbol">}</a> <a id="17185" class="Symbol">(</a><a id="17186" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="17194" href="plfa.part3.Soundness.html#17194" class="Bound">d‚ÇÅ</a> <a id="17197" href="plfa.part3.Soundness.html#17197" class="Bound">d‚ÇÇ</a><a id="17199" class="Symbol">)</a> <a id="17201" href="plfa.part3.Soundness.html#17201" class="Bound">eq</a>
  <a id="17206" class="Keyword">with</a> <a id="17211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17225" class="Symbol">{</a><a id="17226" class="Argument">œÉ</a> <a id="17228" class="Symbol">=</a> <a id="17230" href="plfa.part3.Soundness.html#17182" class="Bound">œÉ</a><a id="17231" class="Symbol">}</a> <a id="17233" href="plfa.part3.Soundness.html#17194" class="Bound">d‚ÇÅ</a> <a id="17236" href="plfa.part3.Soundness.html#17201" class="Bound">eq</a> <a id="17239" class="Symbol">|</a> <a id="17241" href="plfa.part3.Soundness.html#15579" class="Function">subst-reflect</a> <a id="17255" class="Symbol">{</a><a id="17256" class="Argument">œÉ</a> <a id="17258" class="Symbol">=</a> <a id="17260" href="plfa.part3.Soundness.html#17182" class="Bound">œÉ</a><a id="17261" class="Symbol">}</a> <a id="17263" href="plfa.part3.Soundness.html#17197" class="Bound">d‚ÇÇ</a> <a id="17266" href="plfa.part3.Soundness.html#17201" class="Bound">eq</a>
<a id="17269" class="Symbol">...</a> <a id="17273" class="Symbol">|</a> <a id="17275" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17277" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#17277" class="Bound">Œ¥‚ÇÅ</a> <a id="17280" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17282" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17284" href="plfa.part3.Soundness.html#17284" class="Bound">subst-Œ¥‚ÇÅ</a> <a id="17293" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17295" href="plfa.part3.Soundness.html#17295" class="Bound">m1</a> <a id="17298" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17300" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17302" class="Symbol">|</a> <a id="17304" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17306" href="plfa.part3.Soundness.html#17306" class="Bound">Œ¥‚ÇÇ</a> <a id="17309" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17311" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17313" href="plfa.part3.Soundness.html#17313" class="Bound">subst-Œ¥‚ÇÇ</a> <a id="17322" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17324" href="plfa.part3.Soundness.html#17324" class="Bound">m2</a> <a id="17327" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17329" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17331" class="Symbol">=</a>
     <a id="17338" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#17277" class="Bound">Œ¥‚ÇÅ</a> <a id="17343" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8256" class="Function Operator">`‚äî</a> <a id="17346" href="plfa.part3.Soundness.html#17306" class="Bound">Œ¥‚ÇÇ</a> <a id="17349" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17351" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17353" href="plfa.part3.Soundness.html#14588" class="Function">subst-‚äî</a> <a id="17361" class="Symbol">{</a><a id="17362" class="Argument">Œ≥‚ÇÅ</a> <a id="17365" class="Symbol">=</a> <a id="17367" href="plfa.part3.Soundness.html#17277" class="Bound">Œ¥‚ÇÅ</a><a id="17369" class="Symbol">}{</a><a id="17371" class="Argument">Œ≥‚ÇÇ</a> <a id="17374" class="Symbol">=</a> <a id="17376" href="plfa.part3.Soundness.html#17306" class="Bound">Œ¥‚ÇÇ</a><a id="17378" class="Symbol">}{</a><a id="17380" class="Argument">œÉ</a> <a id="17382" class="Symbol">=</a> <a id="17384" class="Bound">œÉ</a><a id="17385" class="Symbol">}</a> <a id="17387" href="plfa.part3.Soundness.html#17284" class="Bound">subst-Œ¥‚ÇÅ</a> <a id="17396" href="plfa.part3.Soundness.html#17313" class="Bound">subst-Œ¥‚ÇÇ</a> <a id="17405" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>
                    <a id="17427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="17435" class="Symbol">(</a><a id="17436" href="plfa.part3.Denotational.html#25631" class="Function">‚äë-env</a> <a id="17442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#17295" class="Bound">m1</a> <a id="17445" class="Symbol">(</a><a id="17446" href="plfa.part3.Denotational.html#8586" class="Function">‚äë-env-conj-R1</a> <a id="17460" href="plfa.part3.Soundness.html#17277" class="Bound">Œ¥‚ÇÅ</a> <a id="17463" href="plfa.part3.Soundness.html#17306" class="Bound">Œ¥‚ÇÇ</a><a id="17465" class="Symbol">))</a>
                            <a id="17496" class="Symbol">(</a><a id="17497" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#25631" class="Function">‚äë-env</a> <a id="17503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#17324" class="Bound">m2</a> <a id="17506" class="Symbol">(</a><a id="17507" href="plfa.part3.Denotational.html#8692" class="Function">‚äë-env-conj-R2</a> <a id="17521" href="plfa.part3.Soundness.html#17277" class="Bound">Œ¥‚ÇÅ</a> <a id="17524" href="plfa.part3.Soundness.html#17306" class="Bound">Œ¥‚ÇÇ</a><a id="17526" class="Symbol">))</a> <a id="17529" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17531" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
<a id="17533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17547" class="Symbol">(</a><a id="17548" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="17552" href="plfa.part3.Soundness.html#17552" class="Bound">d</a> <a id="17554" href="plfa.part3.Soundness.html#17554" class="Bound">lt</a><a id="17556" class="Symbol">)</a> <a id="17558" href="plfa.part3.Soundness.html#17558" class="Bound">eq</a>
    <a id="17565" class="Keyword">with</a> <a id="17570" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#15579" class="Function">subst-reflect</a> <a id="17584" href="plfa.part3.Soundness.html#17552" class="Bound">d</a> <a id="17586" href="plfa.part3.Soundness.html#17558" class="Bound">eq</a>
<a id="17589" class="Symbol">...</a> <a id="17593" class="Symbol">|</a> <a id="17595" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17597" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#17597" class="Bound">Œ¥</a> <a id="17599" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17601" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17603" href="plfa.part3.Soundness.html#17603" class="Bound">subst-Œ¥</a> <a id="17611" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17613" href="plfa.part3.Soundness.html#17613" class="Bound">m</a> <a id="17615" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17617" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17619" class="Symbol">=</a> <a id="17621" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17623" href="plfa.part3.Soundness.html#17597" class="Bound">Œ¥</a> <a id="17625" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17627" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="17629" href="plfa.part3.Soundness.html#17603" class="Bound">subst-Œ¥</a> <a id="17637" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="17639" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="17643" href="plfa.part3.Soundness.html#17613" class="Bound">m</a> <a id="17645" class="Bound">lt</a> <a id="17648" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="17650" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
</pre>{% endraw %}
* Case `var`: We have subst `œÉ M ‚â° y`, so `M` must also be a variable, say `x`.
  We apply the lemma `subst-reflect-var` to conclude.

* Case `‚Ü¶-elim`: We have `subst œÉ M ‚â° L‚ÇÅ ¬∑ L‚ÇÇ`. We proceed by cases on `M`.
  * Case `M ‚â° x`: We apply the `subst-reflect-var` lemma again to conclude.

  * Case `M ‚â° M‚ÇÅ ¬∑ M‚ÇÇ`: By the induction hypothesis, we have
    some `Œ¥‚ÇÅ` and `Œ¥‚ÇÇ` such that `Œ¥‚ÇÅ ‚ä¢ M‚ÇÅ ‚Üì v‚ÇÅ ‚Ü¶ v‚ÇÉ` and `Œ≥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÅ`,
    as well as `Œ¥‚ÇÇ ‚ä¢ M‚ÇÇ ‚Üì v‚ÇÅ` and `Œ≥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÇ`.
    By `‚äë-env` we have `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M‚ÇÅ ‚Üì v‚ÇÅ ‚Ü¶ v‚ÇÉ` and `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M‚ÇÇ ‚Üì v‚ÇÅ`
    (using `‚äë-env-conj-R1` and `‚äë-env-conj-R2`), and therefore
    `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M‚ÇÅ ¬∑ M‚ÇÇ ‚Üì v‚ÇÉ`.
    We conclude this case by obtaining `Œ≥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ`
    by the `subst-‚äî` lemma.

* Case `‚Ü¶-intro`: We have `subst œÉ M ‚â° ∆õ L‚Ä≤`. We proceed by cases on `M`.
  * Case `M ‚â° x`: We apply the `subst-reflect-var` lemma.

  * Case `M ‚â° ∆õ M‚Ä≤`: By the induction hypothesis, we have
    `(Œ¥‚Ä≤ , v‚Ä≤) ‚ä¢ M‚Ä≤ ‚Üì v‚ÇÇ` and `(Œ¥ , v‚ÇÅ) ‚ä¢ exts œÉ ‚Üì (Œ¥‚Ä≤ , v‚Ä≤)`.
    From the later we have `(Œ¥ , v‚ÇÅ) ‚ä¢ # 0 ‚Üì v‚Ä≤`.
    By the lemma `var-inv` we have `v‚Ä≤ ‚äë v‚ÇÅ`, so by the `up-env` lemma we
    have `(Œ¥‚Ä≤ , v‚ÇÅ) ‚ä¢ M‚Ä≤ ‚Üì v‚ÇÇ` and therefore `Œ¥‚Ä≤ ‚ä¢ ∆õ M‚Ä≤ ‚Üì v‚ÇÅ ‚Üí v‚ÇÇ`.  We
    also need to show that `Œ¥ `‚ä¢ œÉ ‚Üì Œ¥‚Ä≤`.  Fix `k`. We have
    `(Œ¥ , v‚ÇÅ) ‚ä¢ rename S_ œÉ k ‚Üì Œ¥ k‚Ä≤`.  We then apply the lemma
    `rename-inc-reflect` to obtain `Œ¥ ‚ä¢ œÉ k ‚Üì Œ¥ k‚Ä≤`, so this case is
    complete.

* Case `‚ä•-intro`: We choose `‚ä•` for `Œ¥`.
  We have `‚ä• ‚ä¢ M ‚Üì ‚ä•` by `‚ä•-intro`.
  We have `Œ¥ ‚ä¢ œÉ ‚Üì ‚ä•` by the lemma `subst-empty`.

* Case `‚äî-intro`: By the induction hypothesis we have
  `Œ¥‚ÇÅ ‚ä¢ M ‚Üì v‚ÇÅ`, `Œ¥‚ÇÇ ‚ä¢ M ‚Üì v‚ÇÇ`, `Œ¥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÅ`, and `Œ¥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÇ`.
  We have `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M ‚Üì v‚ÇÅ` and `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M ‚Üì v‚ÇÇ`
  by `‚äë-env` with `‚äë-env-conj-R1` and `‚äë-env-conj-R2`.
  So by `‚äî-intro` we have `Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ ‚ä¢ M ‚Üì v‚ÇÅ ‚äî v‚ÇÇ`.
  By `subst-‚äî` we conclude that `Œ¥ ‚ä¢ œÉ ‚Üì Œ¥‚ÇÅ ‚äî Œ¥‚ÇÇ`.


### Single substitution reflects denotations

Most of the work is now behind us. We have proved that simultaneous
substitution reflects denotations. Of course, Œ≤ reduction uses single
substitution, so we need a corollary that proves that single
substitution reflects denotations. That is,
given terms `N : (Œì , ‚òÖ ‚ä¢ ‚òÖ)` and `M : (Œì ‚ä¢ ‚òÖ)`,
if `Œ≥ ‚ä¢ N [ M ] ‚Üì w`, then `Œ≥ ‚ä¢ M ‚Üì v` and `(Œ≥ , v) ‚ä¢ N ‚Üì w`
for some value `v`. We have `N [ M ] = subst (subst-zero M) N`.

We first prove a lemma about `subst-zero`, that if
`Œ¥ ‚ä¢ subst-zero M ‚Üì Œ≥`, then
`Œ≥ ‚äë (Œ¥ , w) √ó Œ¥ ‚ä¢ M ‚Üì w` for some `w`.

{% raw %}<pre class="Agda"><a id="subst-zero-reflect"></a><a id="20080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20080" class="Function">subst-zero-reflect</a> <a id="20099" class="Symbol">:</a> <a id="20101" class="Symbol">‚àÄ</a> <a id="20103" class="Symbol">{</a><a id="20104" href="plfa.part3.Soundness.html#20104" class="Bound">Œî</a><a id="20105" class="Symbol">}</a> <a id="20107" class="Symbol">{</a><a id="20108" href="plfa.part3.Soundness.html#20108" class="Bound">Œ¥</a> <a id="20110" class="Symbol">:</a> <a id="20112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="20116" href="plfa.part3.Soundness.html#20104" class="Bound">Œî</a><a id="20117" class="Symbol">}</a> <a id="20119" class="Symbol">{</a><a id="20120" href="plfa.part3.Soundness.html#20120" class="Bound">Œ≥</a> <a id="20122" class="Symbol">:</a> <a id="20124" href="plfa.part3.Denotational.html#7204" class="Function">Env</a> <a id="20128" class="Symbol">(</a><a id="20129" href="plfa.part3.Soundness.html#20104" class="Bound">Œî</a> <a id="20131" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="20133" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="20134" class="Symbol">)}</a> <a id="20137" class="Symbol">{</a><a id="20138" href="plfa.part3.Soundness.html#20138" class="Bound">M</a> <a id="20140" class="Symbol">:</a> <a id="20142" href="plfa.part3.Soundness.html#20104" class="Bound">Œî</a> <a id="20144" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="20146" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="20147" class="Symbol">}</a>
  <a id="20151" class="Symbol">‚Üí</a> <a id="20153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20108" class="Bound">Œ¥</a> <a id="20155" href="plfa.part3.Soundness.html#3199" class="Function Operator">`‚ä¢</a> <a id="20158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a> <a id="20169" href="plfa.part3.Soundness.html#20138" class="Bound">M</a> <a id="20171" href="plfa.part3.Soundness.html#3199" class="Function Operator">‚Üì</a> <a id="20173" href="plfa.part3.Soundness.html#20120" class="Bound">Œ≥</a>
    <a id="20179" class="Comment">----------------------------------------</a>
  <a id="20222" class="Symbol">‚Üí</a> <a id="20224" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Œ£[</a> <a id="20227" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20227" class="Bound">w</a> <a id="20229" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">‚àà</a> <a id="20231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4067" class="Datatype">Value</a> <a id="20237" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="20239" href="plfa.part3.Soundness.html#20120" class="Bound">Œ≥</a> <a id="20241" href="plfa.part3.Denotational.html#8024" class="Function Operator">`‚äë</a> <a id="20244" class="Symbol">(</a><a id="20245" href="plfa.part3.Soundness.html#20108" class="Bound">Œ¥</a> <a id="20247" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="20250" href="plfa.part3.Soundness.html#20227" class="Bound">w</a><a id="20251" class="Symbol">)</a> <a id="20253" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">√ó</a> <a id="20255" href="plfa.part3.Soundness.html#20108" class="Bound">Œ¥</a> <a id="20257" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="20259" href="plfa.part3.Soundness.html#20138" class="Bound">M</a> <a id="20261" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="20263" href="plfa.part3.Soundness.html#20227" class="Bound">w</a>
<a id="20265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20080" class="Function">subst-zero-reflect</a> <a id="20284" class="Symbol">{</a><a id="20285" class="Argument">Œ¥</a> <a id="20287" class="Symbol">=</a> <a id="20289" href="plfa.part3.Soundness.html#20289" class="Bound">Œ¥</a><a id="20290" class="Symbol">}</a> <a id="20292" class="Symbol">{</a><a id="20293" class="Argument">Œ≥</a> <a id="20295" class="Symbol">=</a> <a id="20297" href="plfa.part3.Soundness.html#20297" class="Bound">Œ≥</a><a id="20298" class="Symbol">}</a> <a id="20300" href="plfa.part3.Soundness.html#20300" class="Bound">Œ¥œÉŒ≥</a> <a id="20304" class="Symbol">=</a> <a id="20306" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="20308" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7657" class="Function">last</a> <a id="20313" href="plfa.part3.Soundness.html#20297" class="Bound">Œ≥</a> <a id="20315" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="20317" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="20319" href="plfa.part3.Soundness.html#20347" class="Function">lemma</a> <a id="20325" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="20327" href="plfa.part3.Soundness.html#20300" class="Bound">Œ¥œÉŒ≥</a> <a id="20331" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a> <a id="20333" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="20335" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
  <a id="20339" class="Keyword">where</a>
  <a id="20347" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20347" class="Function">lemma</a> <a id="20353" class="Symbol">:</a> <a id="20355" href="plfa.part3.Soundness.html#20297" class="Bound">Œ≥</a> <a id="20357" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#8024" class="Function Operator">`‚äë</a> <a id="20360" class="Symbol">(</a><a id="20361" href="plfa.part3.Soundness.html#20289" class="Bound">Œ¥</a> <a id="20363" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="20366" href="plfa.part3.Denotational.html#7657" class="Function">last</a> <a id="20371" href="plfa.part3.Soundness.html#20297" class="Bound">Œ≥</a><a id="20372" class="Symbol">)</a>
  <a id="20376" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20347" class="Function">lemma</a> <a id="20382" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a>  <a id="20385" class="Symbol">=</a>  <a id="20388" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#5554" class="Function">‚äë-refl</a>
  <a id="20397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20347" class="Function">lemma</a> <a id="20403" class="Symbol">(</a><a id="20404" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="20406" href="plfa.part3.Soundness.html#20406" class="Bound">x</a><a id="20407" class="Symbol">)</a> <a id="20409" class="Symbol">=</a> <a id="20411" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Compositional.md %}{% raw %}#10031" class="Function">var-inv</a> <a id="20419" class="Symbol">(</a><a id="20420" href="plfa.part3.Soundness.html#20300" class="Bound">Œ¥œÉŒ≥</a> <a id="20424" class="Symbol">(</a><a id="20425" href="plfa.part2.Untyped.html#3602" class="InductiveConstructor Operator">S</a> <a id="20427" href="plfa.part3.Soundness.html#20406" class="Bound">x</a><a id="20428" class="Symbol">))</a>
</pre>{% endraw %}
We choose `w` to be the last value in `Œ≥` and we obtain `Œ¥ ‚ä¢ M ‚Üì w`
by applying the premise to variable `Z`. Finally, to prove
`Œ≥ ‚äë (Œ¥ , w)`, we prove a lemma by induction in the input variable.
The base case is trivial because of our choice of `w`.
In the induction case, `S x`, the premise
`Œ¥ ‚ä¢ subst-zero M ‚Üì Œ≥` gives us `Œ¥ ‚ä¢ x ‚Üì Œ≥ (S x)` and then
using `var-inv` we conclude that `Œ≥ (S x) ‚äë (Œ¥ `, w) (S x)`.

Now to prove that substitution reflects denotations.

{% raw %}<pre class="Agda"><a id="substitution-reflect"></a><a id="20907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20907" class="Function">substitution-reflect</a> <a id="20928" class="Symbol">:</a> <a id="20930" class="Symbol">‚àÄ</a> <a id="20932" class="Symbol">{</a><a id="20933" href="plfa.part3.Soundness.html#20933" class="Bound">Œî</a><a id="20934" class="Symbol">}</a> <a id="20936" class="Symbol">{</a><a id="20937" href="plfa.part3.Soundness.html#20937" class="Bound">Œ¥</a> <a id="20939" class="Symbol">:</a> <a id="20941" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="20945" href="plfa.part3.Soundness.html#20933" class="Bound">Œî</a><a id="20946" class="Symbol">}</a> <a id="20948" class="Symbol">{</a><a id="20949" href="plfa.part3.Soundness.html#20949" class="Bound">N</a> <a id="20951" class="Symbol">:</a> <a id="20953" href="plfa.part3.Soundness.html#20933" class="Bound">Œî</a> <a id="20955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="20957" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a> <a id="20959" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="20961" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="20962" class="Symbol">}</a> <a id="20964" class="Symbol">{</a><a id="20965" href="plfa.part3.Soundness.html#20965" class="Bound">M</a> <a id="20967" class="Symbol">:</a> <a id="20969" href="plfa.part3.Soundness.html#20933" class="Bound">Œî</a> <a id="20971" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="20973" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="20974" class="Symbol">}</a> <a id="20976" class="Symbol">{</a><a id="20977" href="plfa.part3.Soundness.html#20977" class="Bound">v</a><a id="20978" class="Symbol">}</a>
  <a id="20982" class="Symbol">‚Üí</a> <a id="20984" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20937" class="Bound">Œ¥</a> <a id="20986" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="20988" href="plfa.part3.Soundness.html#20949" class="Bound">N</a> <a id="20990" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="20992" href="plfa.part3.Soundness.html#20965" class="Bound">M</a> <a id="20994" href="plfa.part2.Untyped.html#7491" class="Function Operator">]</a> <a id="20996" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="20998" href="plfa.part3.Soundness.html#20977" class="Bound">v</a>
    <a id="21004" class="Comment">------------------------------------------------</a>
  <a id="21055" class="Symbol">‚Üí</a> <a id="21057" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">Œ£[</a> <a id="21060" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21060" class="Bound">w</a> <a id="21062" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">‚àà</a> <a id="21064" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#4067" class="Datatype">Value</a> <a id="21070" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#911" class="Function">]</a> <a id="21072" href="plfa.part3.Soundness.html#20937" class="Bound">Œ¥</a> <a id="21074" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="21076" href="plfa.part3.Soundness.html#20965" class="Bound">M</a> <a id="21078" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="21080" href="plfa.part3.Soundness.html#21060" class="Bound">w</a>  <a id="21083" href="https://agda.github.io/agda-stdlib/v1.1/Data.Product.html#1162" class="Function Operator">√ó</a>  <a id="21086" class="Symbol">(</a><a id="21087" href="plfa.part3.Soundness.html#20937" class="Bound">Œ¥</a> <a id="21089" href="plfa.part3.Denotational.html#7361" class="Function Operator">`,</a> <a id="21092" href="plfa.part3.Soundness.html#21060" class="Bound">w</a><a id="21093" class="Symbol">)</a> <a id="21095" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚ä¢</a> <a id="21097" href="plfa.part3.Soundness.html#20949" class="Bound">N</a> <a id="21099" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="21101" href="plfa.part3.Soundness.html#20977" class="Bound">v</a>
<a id="21103" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20907" class="Function">substitution-reflect</a> <a id="21124" href="plfa.part3.Soundness.html#21124" class="Bound">d</a> <a id="21126" class="Keyword">with</a> <a id="21131" href="plfa.part3.Soundness.html#15579" class="Function">subst-reflect</a> <a id="21145" href="plfa.part3.Soundness.html#21124" class="Bound">d</a> <a id="21147" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="21152" class="Symbol">...</a>  <a id="21157" class="Symbol">|</a> <a id="21159" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21161" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21161" class="Bound">Œ≥</a> <a id="21163" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21165" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21167" href="plfa.part3.Soundness.html#21167" class="Bound">Œ¥œÉŒ≥</a> <a id="21171" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21173" href="plfa.part3.Soundness.html#21173" class="Bound">Œ≥Nv</a> <a id="21177" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21179" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21181" class="Keyword">with</a> <a id="21186" href="plfa.part3.Soundness.html#20080" class="Function">subst-zero-reflect</a> <a id="21205" href="plfa.part3.Soundness.html#21167" class="Bound">Œ¥œÉŒ≥</a>
<a id="21209" class="Symbol">...</a>    <a id="21216" class="Symbol">|</a> <a id="21218" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21220" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21220" class="Bound">w</a> <a id="21222" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21224" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21226" href="plfa.part3.Soundness.html#21226" class="Bound">ineq</a> <a id="21231" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21233" href="plfa.part3.Soundness.html#21233" class="Bound">Œ¥Mw</a> <a id="21237" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21239" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21241" class="Symbol">=</a> <a id="21243" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21245" href="plfa.part3.Soundness.html#21220" class="Bound">w</a> <a id="21247" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21249" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21251" href="plfa.part3.Soundness.html#21233" class="Bound">Œ¥Mw</a> <a id="21255" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#25631" class="Function">‚äë-env</a> <a id="21263" class="Bound">Œ≥Nv</a> <a id="21267" href="plfa.part3.Soundness.html#21226" class="Bound">ineq</a> <a id="21272" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21274" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
</pre>{% endraw %}
We apply the `subst-reflect` lemma to obtain
`Œ¥ ‚ä¢ subst-zero M ‚Üì Œ≥` and `Œ≥ ‚ä¢ N ‚Üì v` for some `Œ≥`.
Using the former, the `subst-zero-reflect` lemma gives
us `Œ≥ ‚äë (Œ¥ , w)` and `Œ¥ ‚ä¢ M ‚Üì w`. We conclude that
`Œ¥ , w ‚ä¢ N ‚Üì v` by applying the `‚äë-env` lemma, using
`Œ≥ ‚ä¢ N ‚Üì v` and `Œ≥ ‚äë (Œ¥ , w)`.


### Reduction reflects denotations

Now that we have proved that substitution reflects denotations, we can
easily prove that reduction does too.

{% raw %}<pre class="Agda"><a id="reflect-beta"></a><a id="21721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21721" class="Function">reflect-beta</a> <a id="21734" class="Symbol">:</a> <a id="21736" class="Symbol">‚àÄ{</a><a id="21738" href="plfa.part3.Soundness.html#21738" class="Bound">Œì</a><a id="21739" class="Symbol">}{</a><a id="21741" href="plfa.part3.Soundness.html#21741" class="Bound">Œ≥</a> <a id="21743" class="Symbol">:</a> <a id="21745" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="21749" href="plfa.part3.Soundness.html#21738" class="Bound">Œì</a><a id="21750" class="Symbol">}{</a><a id="21752" href="plfa.part3.Soundness.html#21752" class="Bound">M</a> <a id="21754" href="plfa.part3.Soundness.html#21754" class="Bound">N</a><a id="21755" class="Symbol">}{</a><a id="21757" href="plfa.part3.Soundness.html#21757" class="Bound">v</a><a id="21758" class="Symbol">}</a>
    <a id="21764" class="Symbol">‚Üí</a> <a id="21766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21741" class="Bound">Œ≥</a> <a id="21768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="21770" class="Symbol">(</a><a id="21771" href="plfa.part3.Soundness.html#21754" class="Bound">N</a> <a id="21773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="21775" href="plfa.part3.Soundness.html#21752" class="Bound">M</a> <a id="21777" href="plfa.part2.Untyped.html#7491" class="Function Operator">]</a><a id="21778" class="Symbol">)</a> <a id="21780" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="21782" href="plfa.part3.Soundness.html#21757" class="Bound">v</a>
    <a id="21788" class="Symbol">‚Üí</a> <a id="21790" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21741" class="Bound">Œ≥</a> <a id="21792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="21794" class="Symbol">(</a><a id="21795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="21797" href="plfa.part3.Soundness.html#21754" class="Bound">N</a><a id="21798" class="Symbol">)</a> <a id="21800" href="plfa.part2.Untyped.html#4442" class="InductiveConstructor Operator">¬∑</a> <a id="21802" href="plfa.part3.Soundness.html#21752" class="Bound">M</a> <a id="21804" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="21806" href="plfa.part3.Soundness.html#21757" class="Bound">v</a>
<a id="21808" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21721" class="Function">reflect-beta</a> <a id="21821" href="plfa.part3.Soundness.html#21821" class="Bound">d</a>
    <a id="21827" class="Keyword">with</a> <a id="21832" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#20907" class="Function">substitution-reflect</a> <a id="21853" href="plfa.part3.Soundness.html#21821" class="Bound">d</a>
<a id="21855" class="Symbol">...</a> <a id="21859" class="Symbol">|</a> <a id="21861" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21863" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21863" class="Bound">v‚ÇÇ‚Ä≤</a> <a id="21867" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21869" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="21871" href="plfa.part3.Soundness.html#21871" class="Bound">d‚ÇÅ‚Ä≤</a> <a id="21875" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="21877" href="plfa.part3.Soundness.html#21877" class="Bound">d‚ÇÇ‚Ä≤</a> <a id="21881" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21883" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a> <a id="21885" class="Symbol">=</a> <a id="21887" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="21894" class="Symbol">(</a><a id="21895" href="plfa.part3.Denotational.html#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="21903" href="plfa.part3.Soundness.html#21877" class="Bound">d‚ÇÇ‚Ä≤</a><a id="21906" class="Symbol">)</a> <a id="21908" href="plfa.part3.Soundness.html#21871" class="Bound">d‚ÇÅ‚Ä≤</a>


<a id="reflect"></a><a id="21914" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="21922" class="Symbol">:</a> <a id="21924" class="Symbol">‚àÄ</a> <a id="21926" class="Symbol">{</a><a id="21927" href="plfa.part3.Soundness.html#21927" class="Bound">Œì</a><a id="21928" class="Symbol">}</a> <a id="21930" class="Symbol">{</a><a id="21931" href="plfa.part3.Soundness.html#21931" class="Bound">Œ≥</a> <a id="21933" class="Symbol">:</a> <a id="21935" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#7204" class="Function">Env</a> <a id="21939" href="plfa.part3.Soundness.html#21927" class="Bound">Œì</a><a id="21940" class="Symbol">}</a> <a id="21942" class="Symbol">{</a><a id="21943" href="plfa.part3.Soundness.html#21943" class="Bound">M</a> <a id="21945" href="plfa.part3.Soundness.html#21945" class="Bound">M‚Ä≤</a> <a id="21948" href="plfa.part3.Soundness.html#21948" class="Bound">N</a> <a id="21950" href="plfa.part3.Soundness.html#21950" class="Bound">v</a><a id="21951" class="Symbol">}</a>
  <a id="21955" class="Symbol">‚Üí</a> <a id="21957" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21931" class="Bound">Œ≥</a> <a id="21959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="21961" href="plfa.part3.Soundness.html#21948" class="Bound">N</a> <a id="21963" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="21965" href="plfa.part3.Soundness.html#21950" class="Bound">v</a>  <a id="21968" class="Symbol">‚Üí</a>  <a id="21971" href="plfa.part3.Soundness.html#21943" class="Bound">M</a> <a id="21973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">‚Äî‚Üí</a> <a id="21976" href="plfa.part3.Soundness.html#21945" class="Bound">M‚Ä≤</a>  <a id="21980" class="Symbol">‚Üí</a>   <a id="21984" href="plfa.part3.Soundness.html#21945" class="Bound">M‚Ä≤</a> <a id="21987" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">‚â°</a> <a id="21989" href="plfa.part3.Soundness.html#21948" class="Bound">N</a>
    <a id="21995" class="Comment">---------------------------------</a>
  <a id="22031" class="Symbol">‚Üí</a> <a id="22033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21931" class="Bound">Œ≥</a> <a id="22035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9262" class="Datatype Operator">‚ä¢</a> <a id="22037" href="plfa.part3.Soundness.html#21943" class="Bound">M</a> <a id="22039" href="plfa.part3.Denotational.html#9262" class="Datatype Operator">‚Üì</a> <a id="22041" href="plfa.part3.Soundness.html#21950" class="Bound">v</a>
<a id="22043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22051" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="22055" class="Symbol">(</a><a id="22056" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Œæ‚ÇÅ</a> <a id="22059" href="plfa.part3.Soundness.html#22059" class="Bound">r</a><a id="22060" class="Symbol">)</a> <a id="22062" class="Symbol">()</a>
<a id="22065" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="22077" class="Symbol">(</a><a id="22078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Œæ‚ÇÇ</a> <a id="22081" href="plfa.part3.Soundness.html#22081" class="Bound">r</a><a id="22082" class="Symbol">)</a> <a id="22084" class="Symbol">()</a>
<a id="22087" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a><a id="22094" class="Symbol">{</a><a id="22095" class="Argument">Œ≥</a> <a id="22097" class="Symbol">=</a> <a id="22099" href="plfa.part3.Soundness.html#22099" class="Bound">Œ≥</a><a id="22100" class="Symbol">}</a> <a id="22102" class="Symbol">(</a><a id="22103" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a><a id="22106" class="Symbol">{</a><a id="22107" class="Argument">x</a> <a id="22109" class="Symbol">=</a> <a id="22111" href="plfa.part3.Soundness.html#22111" class="Bound">x</a><a id="22112" class="Symbol">})</a> <a id="22115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Œ≤</a> <a id="22117" href="plfa.part3.Soundness.html#22117" class="Bound">mn</a>
    <a id="22124" class="Keyword">with</a> <a id="22129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a><a id="22132" class="Symbol">{</a><a id="22133" class="Argument">Œ≥</a> <a id="22135" class="Symbol">=</a> <a id="22137" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22099" class="Bound">Œ≥</a><a id="22138" class="Symbol">}{</a><a id="22140" class="Argument">x</a> <a id="22142" class="Symbol">=</a> <a id="22144" href="plfa.part3.Soundness.html#22111" class="Bound">x</a><a id="22145" class="Symbol">}</a>
<a id="22147" class="Symbol">...</a> <a id="22151" class="Symbol">|</a> <a id="22153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22153" class="Bound">d‚Ä≤</a> <a id="22156" class="Keyword">rewrite</a> <a id="22164" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22168" class="Bound">mn</a> <a id="22171" class="Symbol">=</a> <a id="22173" href="plfa.part3.Soundness.html#21721" class="Function">reflect-beta</a> <a id="22186" href="plfa.part3.Soundness.html#22153" class="Bound">d‚Ä≤</a>
<a id="22189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22197" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9316" class="InductiveConstructor">var</a> <a id="22201" class="Symbol">(</a><a id="22202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Œ∂</a> <a id="22204" href="plfa.part3.Soundness.html#22204" class="Bound">r</a><a id="22205" class="Symbol">)</a> <a id="22207" class="Symbol">()</a>
<a id="22210" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22218" class="Symbol">(</a><a id="22219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22226" href="plfa.part3.Soundness.html#22226" class="Bound">d‚ÇÅ</a> <a id="22229" href="plfa.part3.Soundness.html#22229" class="Bound">d‚ÇÇ</a><a id="22231" class="Symbol">)</a> <a id="22233" class="Symbol">(</a><a id="22234" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Œæ‚ÇÅ</a> <a id="22237" href="plfa.part3.Soundness.html#22237" class="Bound">r</a><a id="22238" class="Symbol">)</a> <a id="22240" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22245" class="Symbol">=</a> <a id="22247" href="plfa.part3.Denotational.html#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22254" class="Symbol">(</a><a id="22255" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="22263" href="plfa.part3.Soundness.html#22226" class="Bound">d‚ÇÅ</a> <a id="22266" href="plfa.part3.Soundness.html#22237" class="Bound">r</a> <a id="22268" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22272" class="Symbol">)</a> <a id="22274" href="plfa.part3.Soundness.html#22229" class="Bound">d‚ÇÇ</a>
<a id="22277" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22285" class="Symbol">(</a><a id="22286" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22293" href="plfa.part3.Soundness.html#22293" class="Bound">d‚ÇÅ</a> <a id="22296" href="plfa.part3.Soundness.html#22296" class="Bound">d‚ÇÇ</a><a id="22298" class="Symbol">)</a> <a id="22300" class="Symbol">(</a><a id="22301" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Œæ‚ÇÇ</a> <a id="22304" href="plfa.part3.Soundness.html#22304" class="Bound">r</a><a id="22305" class="Symbol">)</a> <a id="22307" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22312" class="Symbol">=</a> <a id="22314" href="plfa.part3.Denotational.html#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22321" href="plfa.part3.Soundness.html#22293" class="Bound">d‚ÇÅ</a> <a id="22324" class="Symbol">(</a><a id="22325" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="22333" href="plfa.part3.Soundness.html#22296" class="Bound">d‚ÇÇ</a> <a id="22336" href="plfa.part3.Soundness.html#22304" class="Bound">r</a> <a id="22338" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22342" class="Symbol">)</a>
<a id="22344" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22352" class="Symbol">(</a><a id="22353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22360" href="plfa.part3.Soundness.html#22360" class="Bound">d‚ÇÅ</a> <a id="22363" href="plfa.part3.Soundness.html#22363" class="Bound">d‚ÇÇ</a><a id="22365" class="Symbol">)</a> <a id="22367" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Œ≤</a> <a id="22369" href="plfa.part3.Soundness.html#22369" class="Bound">mn</a>
    <a id="22376" class="Keyword">with</a> <a id="22381" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22388" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22360" class="Bound">d‚ÇÅ</a> <a id="22391" href="plfa.part3.Soundness.html#22363" class="Bound">d‚ÇÇ</a>
<a id="22394" class="Symbol">...</a> <a id="22398" class="Symbol">|</a> <a id="22400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22400" class="Bound">d‚Ä≤</a> <a id="22403" class="Keyword">rewrite</a> <a id="22411" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22415" class="Bound">mn</a> <a id="22418" class="Symbol">=</a> <a id="22420" href="plfa.part3.Soundness.html#21721" class="Function">reflect-beta</a> <a id="22433" href="plfa.part3.Soundness.html#22400" class="Bound">d‚Ä≤</a>
<a id="22436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22444" class="Symbol">(</a><a id="22445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9391" class="InductiveConstructor">‚Ü¶-elim</a> <a id="22452" href="plfa.part3.Soundness.html#22452" class="Bound">d‚ÇÅ</a> <a id="22455" href="plfa.part3.Soundness.html#22455" class="Bound">d‚ÇÇ</a><a id="22457" class="Symbol">)</a> <a id="22459" class="Symbol">(</a><a id="22460" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Œ∂</a> <a id="22462" href="plfa.part3.Soundness.html#22462" class="Bound">r</a><a id="22463" class="Symbol">)</a> <a id="22465" class="Symbol">()</a>
<a id="22468" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22476" class="Symbol">(</a><a id="22477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22485" href="plfa.part3.Soundness.html#22485" class="Bound">d</a><a id="22486" class="Symbol">)</a> <a id="22488" class="Symbol">(</a><a id="22489" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Œæ‚ÇÅ</a> <a id="22492" href="plfa.part3.Soundness.html#22492" class="Bound">r</a><a id="22493" class="Symbol">)</a> <a id="22495" class="Symbol">()</a>
<a id="22498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22506" class="Symbol">(</a><a id="22507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22515" href="plfa.part3.Soundness.html#22515" class="Bound">d</a><a id="22516" class="Symbol">)</a> <a id="22518" class="Symbol">(</a><a id="22519" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Œæ‚ÇÇ</a> <a id="22522" href="plfa.part3.Soundness.html#22522" class="Bound">r</a><a id="22523" class="Symbol">)</a> <a id="22525" class="Symbol">()</a>
<a id="22528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22536" class="Symbol">(</a><a id="22537" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22545" href="plfa.part3.Soundness.html#22545" class="Bound">d</a><a id="22546" class="Symbol">)</a> <a id="22548" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Œ≤</a> <a id="22550" href="plfa.part3.Soundness.html#22550" class="Bound">mn</a>
    <a id="22557" class="Keyword">with</a> <a id="22562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22570" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22545" class="Bound">d</a>
<a id="22572" class="Symbol">...</a> <a id="22576" class="Symbol">|</a> <a id="22578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#22578" class="Bound">d‚Ä≤</a> <a id="22581" class="Keyword">rewrite</a> <a id="22589" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22593" class="Bound">mn</a> <a id="22596" class="Symbol">=</a> <a id="22598" href="plfa.part3.Soundness.html#21721" class="Function">reflect-beta</a> <a id="22611" href="plfa.part3.Soundness.html#22578" class="Bound">d‚Ä≤</a>
<a id="22614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22622" class="Symbol">(</a><a id="22623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22631" href="plfa.part3.Soundness.html#22631" class="Bound">d</a><a id="22632" class="Symbol">)</a> <a id="22634" class="Symbol">(</a><a id="22635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Œ∂</a> <a id="22637" href="plfa.part3.Soundness.html#22637" class="Bound">r</a><a id="22638" class="Symbol">)</a> <a id="22640" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="22645" class="Symbol">=</a> <a id="22647" href="plfa.part3.Denotational.html#9513" class="InductiveConstructor">‚Ü¶-intro</a> <a id="22655" class="Symbol">(</a><a id="22656" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="22664" href="plfa.part3.Soundness.html#22631" class="Bound">d</a> <a id="22666" href="plfa.part3.Soundness.html#22637" class="Bound">r</a> <a id="22668" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22672" class="Symbol">)</a>
<a id="22674" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22682" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9625" class="InductiveConstructor">‚ä•-intro</a> <a id="22690" href="plfa.part3.Soundness.html#22690" class="Bound">r</a> <a id="22692" href="plfa.part3.Soundness.html#22692" class="Bound">mn</a> <a id="22695" class="Symbol">=</a> <a id="22697" href="plfa.part3.Denotational.html#9625" class="InductiveConstructor">‚ä•-intro</a>
<a id="22705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22713" class="Symbol">(</a><a id="22714" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="22722" href="plfa.part3.Soundness.html#22722" class="Bound">d‚ÇÅ</a> <a id="22725" href="plfa.part3.Soundness.html#22725" class="Bound">d‚ÇÇ</a><a id="22727" class="Symbol">)</a> <a id="22729" href="plfa.part3.Soundness.html#22729" class="Bound">r</a> <a id="22731" href="plfa.part3.Soundness.html#22731" class="Bound">mn</a> <a id="22734" class="Keyword">rewrite</a> <a id="22742" href="https://agda.github.io/agda-stdlib/v1.1/Relation.Binary.PropositionalEquality.Core.html#939" class="Function">sym</a> <a id="22746" href="plfa.part3.Soundness.html#22731" class="Bound">mn</a> <a id="22749" class="Symbol">=</a>
   <a id="22754" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9692" class="InductiveConstructor">‚äî-intro</a> <a id="22762" class="Symbol">(</a><a id="22763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22771" href="plfa.part3.Soundness.html#22722" class="Bound">d‚ÇÅ</a> <a id="22774" href="plfa.part3.Soundness.html#22729" class="Bound">r</a> <a id="22776" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22780" class="Symbol">)</a> <a id="22782" class="Symbol">(</a><a id="22783" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="22791" href="plfa.part3.Soundness.html#22725" class="Bound">d‚ÇÇ</a> <a id="22794" href="plfa.part3.Soundness.html#22729" class="Bound">r</a> <a id="22796" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="22800" class="Symbol">)</a>
<a id="22802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#21914" class="Function">reflect</a> <a id="22810" class="Symbol">(</a><a id="22811" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#9807" class="InductiveConstructor">sub</a> <a id="22815" href="plfa.part3.Soundness.html#22815" class="Bound">d</a> <a id="22817" href="plfa.part3.Soundness.html#22817" class="Bound">lt</a><a id="22819" class="Symbol">)</a> <a id="22821" href="plfa.part3.Soundness.html#22821" class="Bound">r</a> <a id="22823" href="plfa.part3.Soundness.html#22823" class="Bound">mn</a> <a id="22826" class="Symbol">=</a> <a id="22828" href="plfa.part3.Denotational.html#9807" class="InductiveConstructor">sub</a> <a id="22832" class="Symbol">(</a><a id="22833" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="22841" href="plfa.part3.Soundness.html#22815" class="Bound">d</a> <a id="22843" href="plfa.part3.Soundness.html#22821" class="Bound">r</a> <a id="22845" href="plfa.part3.Soundness.html#22823" class="Bound">mn</a><a id="22847" class="Symbol">)</a> <a id="22849" href="plfa.part3.Soundness.html#22817" class="Bound">lt</a>
</pre>{% endraw %}
## Reduction implies denotational equality

We have proved that reduction both preserves and reflects
denotations. Thus, reduction implies denotational equality.

{% raw %}<pre class="Agda"><a id="reduce-equal"></a><a id="23024" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23024" class="Function">reduce-equal</a> <a id="23037" class="Symbol">:</a> <a id="23039" class="Symbol">‚àÄ</a> <a id="23041" class="Symbol">{</a><a id="23042" href="plfa.part3.Soundness.html#23042" class="Bound">Œì</a><a id="23043" class="Symbol">}</a> <a id="23045" class="Symbol">{</a><a id="23046" href="plfa.part3.Soundness.html#23046" class="Bound">M</a> <a id="23048" class="Symbol">:</a> <a id="23050" href="plfa.part3.Soundness.html#23042" class="Bound">Œì</a> <a id="23052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="23054" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="23055" class="Symbol">}</a> <a id="23057" class="Symbol">{</a><a id="23058" href="plfa.part3.Soundness.html#23058" class="Bound">N</a> <a id="23060" class="Symbol">:</a> <a id="23062" href="plfa.part3.Soundness.html#23042" class="Bound">Œì</a> <a id="23064" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="23066" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="23067" class="Symbol">}</a>
  <a id="23071" class="Symbol">‚Üí</a> <a id="23073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23046" class="Bound">M</a> <a id="23075" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">‚Äî‚Üí</a> <a id="23078" href="plfa.part3.Soundness.html#23058" class="Bound">N</a>
    <a id="23084" class="Comment">---------</a>
  <a id="23096" class="Symbol">‚Üí</a> <a id="23098" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#17393" class="Function">‚Ñ∞</a> <a id="23100" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23046" class="Bound">M</a> <a id="23102" href="plfa.part3.Denotational.html#17575" class="Function Operator">‚âÉ</a> <a id="23104" href="plfa.part3.Denotational.html#17393" class="Function">‚Ñ∞</a> <a id="23106" href="plfa.part3.Soundness.html#23058" class="Bound">N</a>
<a id="23108" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23024" class="Function">reduce-equal</a> <a id="23121" class="Symbol">{</a><a id="23122" href="plfa.part3.Soundness.html#23122" class="Bound">Œì</a><a id="23123" class="Symbol">}{</a><a id="23125" href="plfa.part3.Soundness.html#23125" class="Bound">M</a><a id="23126" class="Symbol">}{</a><a id="23128" href="plfa.part3.Soundness.html#23128" class="Bound">N</a><a id="23129" class="Symbol">}</a> <a id="23131" href="plfa.part3.Soundness.html#23131" class="Bound">r</a> <a id="23133" href="plfa.part3.Soundness.html#23133" class="Bound">Œ≥</a> <a id="23135" href="plfa.part3.Soundness.html#23135" class="Bound">v</a> <a id="23137" class="Symbol">=</a>
    <a id="23143" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="23145" class="Symbol">(Œª</a> <a id="23148" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23148" class="Bound">m</a> <a id="23150" class="Symbol">‚Üí</a> <a id="23152" href="plfa.part3.Soundness.html#6614" class="Function">preserve</a> <a id="23161" href="plfa.part3.Soundness.html#23148" class="Bound">m</a> <a id="23163" href="plfa.part3.Soundness.html#23131" class="Bound">r</a><a id="23164" class="Symbol">)</a> <a id="23166" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="23168" class="Symbol">(Œª</a> <a id="23171" href="plfa.part3.Soundness.html#23171" class="Bound">n</a> <a id="23173" class="Symbol">‚Üí</a> <a id="23175" href="plfa.part3.Soundness.html#21914" class="Function">reflect</a> <a id="23183" href="plfa.part3.Soundness.html#23171" class="Bound">n</a> <a id="23185" href="plfa.part3.Soundness.html#23131" class="Bound">r</a> <a id="23187" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="23191" class="Symbol">)</a> <a id="23193" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
</pre>{% endraw %}
We conclude with the _soundness property_, that multi-step reduction
to a lambda abstraction implies denotational equivalence with a lambda
abstraction.

{% raw %}<pre class="Agda"><a id="soundness"></a><a id="23358" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23358" class="Function">soundness</a> <a id="23368" class="Symbol">:</a> <a id="23370" class="Symbol">‚àÄ{</a><a id="23372" href="plfa.part3.Soundness.html#23372" class="Bound">Œì</a><a id="23373" class="Symbol">}</a> <a id="23375" class="Symbol">{</a><a id="23376" href="plfa.part3.Soundness.html#23376" class="Bound">M</a> <a id="23378" class="Symbol">:</a> <a id="23380" href="plfa.part3.Soundness.html#23372" class="Bound">Œì</a> <a id="23382" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">‚ä¢</a> <a id="23384" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="23385" class="Symbol">}</a> <a id="23387" class="Symbol">{</a><a id="23388" href="plfa.part3.Soundness.html#23388" class="Bound">N</a> <a id="23390" class="Symbol">:</a> <a id="23392" href="plfa.part3.Soundness.html#23372" class="Bound">Œì</a> <a id="23394" href="plfa.part2.Untyped.html#3191" class="InductiveConstructor Operator">,</a> <a id="23396" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a> <a id="23398" href="plfa.part2.Untyped.html#4294" class="Datatype Operator">‚ä¢</a> <a id="23400" href="plfa.part2.Untyped.html#2888" class="InductiveConstructor">‚òÖ</a><a id="23401" class="Symbol">}</a>
  <a id="23405" class="Symbol">‚Üí</a> <a id="23407" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23376" class="Bound">M</a> <a id="23409" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">‚Äî‚Ü†</a> <a id="23412" href="plfa.part2.Untyped.html#4382" class="InductiveConstructor Operator">∆õ</a> <a id="23414" href="plfa.part3.Soundness.html#23388" class="Bound">N</a>
    <a id="23420" class="Comment">-----------------</a>
  <a id="23440" class="Symbol">‚Üí</a> <a id="23442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#17393" class="Function">‚Ñ∞</a> <a id="23444" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23376" class="Bound">M</a> <a id="23446" href="plfa.part3.Denotational.html#17575" class="Function Operator">‚âÉ</a> <a id="23448" href="plfa.part3.Denotational.html#17393" class="Function">‚Ñ∞</a> <a id="23450" class="Symbol">(</a><a id="23451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">∆õ</a> <a id="23453" href="plfa.part3.Soundness.html#23388" class="Bound">N</a><a id="23454" class="Symbol">)</a>
<a id="23456" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23358" class="Function">soundness</a> <a id="23466" class="Symbol">(</a><a id="23467" class="DottedPattern Symbol">.(</a><a id="23469" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="DottedPattern InductiveConstructor Operator">∆õ</a> <a id="23471" class="DottedPattern Symbol">_)</a> <a id="23474" href="plfa.part2.Untyped.html#11118" class="InductiveConstructor Operator">‚àé</a><a id="23475" class="Symbol">)</a> <a id="23477" href="plfa.part3.Soundness.html#23477" class="Bound">Œ≥</a> <a id="23479" href="plfa.part3.Soundness.html#23479" class="Bound">v</a> <a id="23481" class="Symbol">=</a> <a id="23483" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü®</a> <a id="23485" class="Symbol">(Œª</a> <a id="23488" href="plfa.part3.Soundness.html#23488" class="Bound">x</a> <a id="23490" class="Symbol">‚Üí</a> <a id="23492" href="plfa.part3.Soundness.html#23488" class="Bound">x</a><a id="23493" class="Symbol">)</a> <a id="23495" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="23497" class="Symbol">(Œª</a> <a id="23500" href="plfa.part3.Soundness.html#23500" class="Bound">x</a> <a id="23502" class="Symbol">‚Üí</a> <a id="23504" href="plfa.part3.Soundness.html#23500" class="Bound">x</a><a id="23505" class="Symbol">)</a> <a id="23507" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">‚ü©</a>
<a id="23509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23358" class="Function">soundness</a> <a id="23519" class="Symbol">{</a><a id="23520" href="plfa.part3.Soundness.html#23520" class="Bound">Œì</a><a id="23521" class="Symbol">}</a> <a id="23523" class="Symbol">(</a><a id="23524" href="plfa.part3.Soundness.html#23524" class="Bound">L</a> <a id="23526" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">‚Äî‚Üí‚ü®</a> <a id="23530" href="plfa.part3.Soundness.html#23530" class="Bound">r</a> <a id="23532" href="plfa.part2.Untyped.html#11174" class="InductiveConstructor Operator">‚ü©</a> <a id="23534" href="plfa.part3.Soundness.html#23534" class="Bound">M‚Äî‚Ü†N</a><a id="23538" class="Symbol">)</a> <a id="23540" href="plfa.part3.Soundness.html#23540" class="Bound">Œ≥</a> <a id="23542" href="plfa.part3.Soundness.html#23542" class="Bound">v</a> <a id="23544" class="Symbol">=</a>
   <a id="23549" class="Keyword">let</a> <a id="23553" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23553" class="Bound">ih</a> <a id="23556" class="Symbol">=</a> <a id="23558" href="plfa.part3.Soundness.html#23358" class="Function">soundness</a> <a id="23568" href="plfa.part3.Soundness.html#23534" class="Bound">M‚Äî‚Ü†N</a> <a id="23573" class="Keyword">in</a>
   <a id="23579" class="Keyword">let</a> <a id="23583" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23583" class="Bound">e</a> <a id="23585" class="Symbol">=</a> <a id="23587" href="plfa.part3.Soundness.html#23024" class="Function">reduce-equal</a> <a id="23600" href="plfa.part3.Soundness.html#23530" class="Bound">r</a> <a id="23602" class="Keyword">in</a>
   <a id="23608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Denotational.md %}{% raw %}#17980" class="Function">‚âÉ-trans</a> <a id="23616" class="Symbol">{</a><a id="23617" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part3/Soundness.md %}{% raw %}#23520" class="Bound">Œì</a><a id="23618" class="Symbol">}</a> <a id="23620" href="plfa.part3.Soundness.html#23583" class="Bound">e</a> <a id="23622" href="plfa.part3.Soundness.html#23553" class="Bound">ih</a> <a id="23625" href="plfa.part3.Soundness.html#23540" class="Bound">Œ≥</a> <a id="23627" href="plfa.part3.Soundness.html#23542" class="Bound">v</a>
</pre>{% endraw %}

## Unicode

This chapter uses the following unicode:

    ‚âü  U+225F  QUESTIONED EQUAL TO (\?=)
